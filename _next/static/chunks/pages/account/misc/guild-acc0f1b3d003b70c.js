(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7196],{19920:function(e,n,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/misc/guild",function(){return l(57811)}])},18747:function(e,n,l){"use strict";var t=l(85893),r=l(14564),i=l(23972);l(67294),n.Z=e=>{let{anchorEl:n,handleClose:l}=e,o=!!n;return(0,t.jsx)(r.ZP,{sx:{ml:1},id:o?"simple-popover":void 0,open:o,anchorEl:n,onClose:l,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},children:(0,t.jsx)(i.Z,{sx:{py:1,px:2},children:"Copied to clipboard!"})})}},89309:function(e,n,l){"use strict";var t=l(85893),r=l(27709),i=l(81458),o=l(23972);l(67294);var s=l(2511);n.Z=e=>{let{percent:n,bgColor:l,label:a=!0,sx:c,boxSx:d={},pre:u,tooltipTitle:h=""}=e;return(0,t.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",...d},children:[u,(0,t.jsx)(r.Z,{sx:{width:"100%",mr:a?1:0},children:(0,t.jsx)(s.Z,{title:h,children:(0,t.jsx)(i.Z,{sx:{width:"100%",height:10,borderRadius:5,"& .MuiLinearProgress-bar":{backgroundColor:l||""},...c},variant:"determinate",value:n>100?100:n})})}),a?(0,t.jsx)(r.Z,{children:(0,t.jsx)(o.Z,{variant:"body2",children:"".concat(Math.round(n),"%")})}):null]})}},30509:function(e,n,l){"use strict";var t=l(85893),r=l(67294),i=l(31002),o=l(29676),s=l(40044),a=l(30925),c=l(27709),d=l(11163);n.Z=e=>{var n;let{tabs:l,components:u,icons:h,children:x,onTabChange:m,forceScroll:v,orientation:p="horizontal",iconsOnly:g,queryKey:Z="t",clearOnChange:j=[],disableQuery:b=!1}=e,f=(0,i.Z)(e=>e.breakpoints.down("md"),{noSsr:!0}),y=(0,d.useRouter)(),[w,S]=(0,r.useState)(0),C=y.query[Z],M=l.findIndex(e=>e===C),T=b?w:M>=0?M:0;(0,r.useEffect)(()=>{b||C||y.replace({pathname:y.pathname,query:{...y.query,[Z]:l[T]}},void 0,{shallow:!0})},[C,Z,l,T,y,b]);let E=Array.isArray(x)?x:[x];return(0,t.jsxs)(c.Z,{sx:"vertical"===p?{flexGrow:1,display:"flex"}:{},children:[(0,t.jsx)(o.Z,{centered:!v&&(!f||f&&l.length<4),scrollButtons:!0,allowScrollButtonsMobile:!0,sx:{marginBottom:3},variant:f&&l.length>=4||v?"scrollable":"standard",value:T,onChange:(e,n)=>{if(b)S(n);else{let e={...y.query,[Z]:l[n]};j.forEach(n=>delete e[n]),y.push({pathname:y.pathname,query:e},void 0,{shallow:!0})}m&&m(n)},children:null===(n=null!=u?u:l)||void 0===n?void 0:n.map((e,n)=>(0,t.jsx)(s.Z,{iconPosition:"start",icon:(null==h?void 0:h[n])?(0,t.jsx)("img",{src:"".concat(a.prefix).concat(null==h?void 0:h[n],".png")}):null,wrapped:!0,label:g?"":e,sx:{minWidth:62}},"".concat(null==e?void 0:e[n],"-").concat(n)))}),m?x:null==E?void 0:E.map((e,n)=>n===T?e:null)]})}},57811:function(e,n,l){"use strict";l.r(n),l.d(n,{default:function(){return guild}});var t=l(85893),r=l(2962),i=l(23972),o=l(51233),s=l(69417),a=l(66242),c=l(44267),d=l(67294),u=l(21480),h=l(30509),x=l(72882),m=l(55113),v=l(7906),p=l(53184),g=l(53816),Z=l(53252),j=l(94780),b=l(90512),f=l(30889),y=(0,l(88169).Z)((0,t.jsx)("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward"),w=l(90948),S=l(16694),C=l(28628),M=l(98216),T=l(1588),E=l(34867);function getTableSortLabelUtilityClass(e){return(0,E.ZP)("MuiTableSortLabel",e)}let G=(0,T.Z)("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc","directionDesc","directionAsc"]);var _=l(80560);let useUtilityClasses=e=>{let{classes:n,direction:l,active:t}=e,r={root:["root",t&&"active",`direction${(0,M.Z)(l)}`],icon:["icon",`iconDirection${(0,M.Z)(l)}`]};return(0,j.Z)(r,getTableSortLabelUtilityClass,n)},k=(0,w.ZP)(f.Z,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,n)=>{let{ownerState:l}=e;return[n.root,l.active&&n.active]}})((0,S.Z)(({theme:e})=>({cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(e.vars||e).palette.text.secondary},"&:hover":{color:(e.vars||e).palette.text.secondary,[`& .${G.icon}`]:{opacity:.5}},[`&.${G.active}`]:{color:(e.vars||e).palette.text.primary,[`& .${G.icon}`]:{opacity:1,color:(e.vars||e).palette.text.secondary}}}))),A=(0,w.ZP)("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,n)=>{let{ownerState:l}=e;return[n.icon,n[`iconDirection${(0,M.Z)(l.direction)}`]]}})((0,S.Z)(({theme:e})=>({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:e.transitions.create(["opacity","transform"],{duration:e.transitions.duration.shorter}),userSelect:"none",variants:[{props:{direction:"desc"},style:{transform:"rotate(0deg)"}},{props:{direction:"asc"},style:{transform:"rotate(180deg)"}}]}))),D=d.forwardRef(function(e,n){let l=(0,C.i)({props:e,name:"MuiTableSortLabel"}),{active:r=!1,children:i,className:o,direction:s="asc",hideSortIcon:a=!1,IconComponent:c=y,slots:d={},slotProps:u={},...h}=l,x={...l,active:r,direction:s,hideSortIcon:a,IconComponent:c},m=useUtilityClasses(x),v={slots:d,slotProps:u},[p,g]=(0,_.Z)("root",{elementType:k,externalForwardedProps:v,ownerState:x,className:(0,b.Z)(m.root,o),ref:n}),[Z,j]=(0,_.Z)("icon",{elementType:A,externalForwardedProps:v,ownerState:x,className:m.icon});return(0,t.jsxs)(p,{disableRipple:!0,component:"span",...g,...h,children:[i,a&&!r?null:(0,t.jsx)(Z,{as:c,...j})]})});var I=l(295),L=l(30925),N=l(27709),P=l(40929),Guild_GuildMembers=e=>{let{members:n,saves:l}=e,[r,o]=(0,d.useState)(),[s,a]=(0,d.useState)("desc"),[c,u]=(0,d.useState)("gpEarned"),h=null==l?void 0:l.slice().sort((e,n)=>n.timestamp-e.timestamp);(0,d.useEffect)(()=>{o(getSortedMembers(n,c,s))},[n]);let getSortedMembers=(e,n,l)=>[...e||[]].sort((e,t)=>"asc"===l?(null==e?void 0:e[n])-(null==t?void 0:t[n]):(null==t?void 0:t[n])-(null==e?void 0:e[n])),handleSort=(e,l)=>{a(l),u(e);let t=getSortedMembers(n,e,l);o(t)};return(0,t.jsx)(x.Z,{component:m.Z,children:(0,t.jsxs)(v.Z,{children:[(0,t.jsxs)(p.Z,{children:[(0,t.jsxs)(g.Z,{children:[(0,t.jsx)(Z.Z,{children:"Name"}),(0,t.jsx)(Z.Z,{sortDirection:s,children:(0,t.jsx)(D,{direction:s,active:"level"===c,onClick:()=>handleSort("level","asc"===s?"desc":"asc"),children:"Level"})}),(0,t.jsx)(Z.Z,{sortDirection:s,align:(null==l?void 0:l.length)===0?"left":"center",colSpan:(null==l?void 0:l.length)||1,children:(0,t.jsx)(D,{direction:s,active:"gpEarned"===c,onClick:()=>handleSort("gpEarned","asc"===s?"desc":"asc"),children:"Earned GP"})}),(0,t.jsx)(Z.Z,{children:"Wanted Bonus"})]}),(null==h?void 0:h.length)>0?(0,t.jsxs)(g.Z,{children:[(0,t.jsx)(Z.Z,{colSpan:2}),null==h?void 0:h.map((e,n)=>{if(e)return(0,t.jsx)(Z.Z,{children:(0,P.Z)(null==e?void 0:e.timestamp,"dd/MM/yyyy HH:mm:ss")},"save"+n)}),(0,t.jsx)(Z.Z,{})]}):null]}),(0,t.jsx)(I.Z,{children:null==r?void 0:r.map((e,n)=>{let{name:r,level:o,gpEarned:s,wantedBonus:a,rank:c}=e,d=null==l?void 0:l.reduce((e,n)=>{var l;let t=null==n?void 0:null===(l=n.members)||void 0===l?void 0:l.find(e=>{let{name:n}=e;return n===r});return[...e,{gpChange:t?s-(null==t?void 0:t.gpEarned):s,timestamp:null==n?void 0:n.timestamp}]},[]);return r?(0,t.jsxs)(g.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,t.jsxs)(Z.Z,{children:[c<5?(0,t.jsx)("img",{src:"".concat(L.prefix,"etc/GuildRank").concat(c,".png"),alt:"rank-".concat(c)}):(0,t.jsx)(N.Z,{component:"span",sx:{display:"inline-block",width:15,height:17}}),(0,t.jsxs)(i.Z,{component:"span",sx:{ml:1},children:[r," ",0===c?"(King)":1===c?"(Leader)":""]})]}),(0,t.jsx)(Z.Z,{children:o}),(null==l?void 0:l.length)===0?(0,t.jsx)(Z.Z,{children:s}):null,d.map((e,n)=>{let{gpChange:l}=e;return(0,t.jsxs)(Z.Z,{children:[(0,t.jsx)(i.Z,{component:"span",mr:1,children:s}),(0,t.jsxs)(i.Z,{variant:"caption",color:l>0?"success.light":"error.light",children:["(",l>0?"+":"",l,")"]})]},"change"+n)}),(0,t.jsx)(Z.Z,{children:(0,L.cleanUnderscore)(null==a?void 0:a.name)||"Guild Gifts"})]},r+o+n):null})})]})})},Guild_GuildBonuses=e=>{let{bonuses:n}=e,getCostToMax=e=>{let{maxLevel:n,level:l,gpBaseCost:t,gpIncrease:r}=e,i=0;for(let e=l;e<n;e++)i+=t+e*r;return i};return(0,t.jsx)(o.Z,{direction:"row",flexWrap:"wrap",gap:2,children:null==n?void 0:n.map((e,n)=>{let{name:l,level:r,gpIncrease:s,maxLevel:d,bonus:u,func:h,x1:x,x2:m,gpBaseCost:v}=e,p=getCostToMax(e);return(0,t.jsx)(a.Z,{sx:{width:300},children:(0,t.jsx)(c.Z,{children:(0,t.jsxs)(o.Z,{gap:2,children:[(0,t.jsxs)(o.Z,{direction:"row",alignItems:"center",gap:2,children:[(0,t.jsx)("img",{src:"".concat(L.prefix,"data/Gbonus").concat(n,".png"),alt:""}),(0,t.jsx)(i.Z,{children:(0,L.cleanUnderscore)(l)})]}),(0,t.jsxs)(o.Z,{gap:1,children:[(0,t.jsxs)(i.Z,{children:["level: ",r," / ",d]}),(0,t.jsxs)(i.Z,{children:["Cost: ",(0,L.notateNumber)(v+r*s)]}),(0,t.jsxs)(i.Z,{children:["Cost To Max: ",(0,L.notateNumber)(p)]}),(0,t.jsx)(i.Z,{sx:{fontSize:16},children:(0,L.cleanUnderscore)(u.replace("{",(0,L.growth)(h,r,x,m)))})]})]})})},l+n)})})},R=l(89309),B=l(18747);let CardTitleAndValue=e=>{let{cardSx:n,title:l,value:r,children:o}=e;return(0,t.jsx)(a.Z,{sx:{my:{xs:0,md:3},width:"fit-content",...n},children:(0,t.jsxs)(c.Z,{children:[(0,t.jsx)(i.Z,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:l}),r?(0,t.jsx)(i.Z,{children:r}):o]})})};var guild=()=>{var e,n,l,a,c,x,m,v;let{state:p}=(0,d.useContext)(u.I),{guild:g}=(null==p?void 0:p.account)||{},[Z,j]=(0,d.useState)([]),[b,f]=d.useState(null),[y,w]=(0,d.useState)("");(0,d.useEffect)(()=>{let e=(0,L.tryToParse)(localStorage.getItem("guild"));e&&j(Array.isArray(e)?e:[e])},[]);let exportToJson=async e=>{f(e.currentTarget);try{var n;let e={date:(0,P.Z)(new Date,"dd/MM/yyyy HH:mm:ss"),members:null==g?void 0:null===(n=g.members)||void 0===n?void 0:n.map(e=>{let{name:n,gpEarned:l}=e;return{name:n,gpEarned:l}})};await navigator.clipboard.writeText(JSON.stringify(e,null,2))}catch(e){console.error("exportToJson -> ",e)}};return g&&(null==g?void 0:null===(e=g.members)||void 0===e?void 0:e.length)!==0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.PB,{title:"Guild | Idleon Toolbox",description:"Keep track of your guild members, gp, bonuses and more"}),(0,t.jsxs)(o.Z,{children:[(0,t.jsxs)(o.Z,{direction:"row",alignItems:"center",gap:1,children:[(0,t.jsx)("img",{src:"".concat(L.prefix,"data/G2icon").concat(null==p?void 0:null===(l=p.account)||void 0===l?void 0:null===(n=l.accountOptions)||void 0===n?void 0:n[38],".png"),alt:"guild-icon"}),(0,t.jsxs)(i.Z,{variant:"h3",children:[null==p?void 0:null===(c=p.account)||void 0===c?void 0:null===(a=c.accountOptions)||void 0===a?void 0:a[37]," ",(0,t.jsxs)(i.Z,{component:"span",variant:"h5",children:["(",null==g?void 0:null===(x=g.members)||void 0===x?void 0:x.length," / ",null==g?void 0:g.maxMembers,")"]})]})]}),(0,t.jsxs)(o.Z,{sx:{mb:1},direction:"row",gap:2,flexWrap:"wrap",children:[(0,t.jsx)(CardTitleAndValue,{title:"Members",value:"".concat(null==g?void 0:null===(m=g.members)||void 0===m?void 0:m.length," / ").concat(null==g?void 0:g.maxMembers)}),(0,t.jsxs)(CardTitleAndValue,{title:"Exp",children:[(0,t.jsx)(R.Z,{boxSx:{width:200},percent:(null==g?void 0:g.totalGp)/Math.round(null==g?void 0:g.levelReq)*100,bgColor:"#f3dd4c"}),(0,t.jsxs)(i.Z,{children:[(0,L.numberWithCommas)(null==g?void 0:g.totalGp)," / ",(0,L.numberWithCommas)(Math.round(null==g?void 0:g.levelReq))]})]}),(0,t.jsx)(CardTitleAndValue,{title:"Saves (up to 3)",children:(0,t.jsxs)(o.Z,{gap:1,children:[(0,t.jsx)(N.Z,{children:null==Z?void 0:null===(v=Z.reverse())||void 0===v?void 0:v.map((e,n)=>{let{timestamp:l}=e;return(0,t.jsxs)(i.Z,{children:["#",n+1," - ",(0,P.Z)(new Date(l),"dd/MM/yyyy HH:mm:ss")]},l+n)})}),(0,t.jsxs)(o.Z,{direction:"row",alignItems:"center",gap:2,children:[(0,t.jsx)(s.Z,{variant:"contained",onClick:()=>{let e;let n=new Date().getTime(),l=(0,L.tryToParse)(localStorage.getItem("guild"));j(e=Array.isArray(l)?[...(l=(null==l?void 0:l.length)>=3?null==l?void 0:l.slice(1):l)||[],{timestamp:n,members:null==g?void 0:g.members}]:l?[l,{timestamp:n,members:null==g?void 0:g.members}]:[{timestamp:n,members:null==g?void 0:g.members}]),localStorage.setItem("guild",JSON.stringify(e)),w("")},children:"Save"}),(0,t.jsx)(s.Z,{variant:"contained",onClick:exportToJson,children:"Export"}),(0,t.jsx)(B.Z,{anchorEl:b,handleClose:()=>f(null)}),(0,t.jsx)(s.Z,{variant:"contained",color:"warning",onClick:()=>{localStorage.removeItem("guild"),j([])},children:"Clear all"})]}),y?(0,t.jsx)(i.Z,{color:"error.light",children:y}):null]})})]})]}),(0,t.jsxs)(h.Z,{tabs:["Members","Bonuses"],children:[(0,t.jsx)(Guild_GuildMembers,{members:null==g?void 0:g.members,saves:Z}),(0,t.jsx)(Guild_GuildBonuses,{bonuses:null==g?void 0:g.guildBonuses})]})]}):(0,t.jsx)(i.Z,{variant:"h3",mb:3,children:"You have to be in a guild to view this page's content"})}}},function(e){e.O(0,[2307,9774,2888,179],function(){return e(e.s=19920)}),_N_E=e.O()}]);