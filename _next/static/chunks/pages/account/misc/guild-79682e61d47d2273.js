(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7196],{19920:function(e,l,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/misc/guild",function(){return n(33190)}])},18747:function(e,l,n){"use strict";var r=n(85893),t=n(14564),i=n(23972);n(67294),l.Z=e=>{let{anchorEl:l,handleClose:n}=e,s=!!l;return(0,r.jsx)(t.ZP,{sx:{ml:1},id:s?"simple-popover":void 0,open:s,anchorEl:l,onClose:n,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},children:(0,r.jsx)(i.Z,{sx:{py:1,px:2},children:"Copied to clipboard!"})})}},89309:function(e,l,n){"use strict";var r=n(85893),t=n(27709),i=n(81458),s=n(23972);n(67294);var o=n(2511);l.Z=e=>{let{percent:l,bgColor:n,label:d=!0,sx:a,boxSx:c={},pre:u,tooltipTitle:h=""}=e;return(0,r.jsxs)(t.Z,{sx:{display:"flex",alignItems:"center",...c},children:[u,(0,r.jsx)(t.Z,{sx:{width:"100%",mr:d?1:0},children:(0,r.jsx)(o.Z,{title:h,children:(0,r.jsx)(i.Z,{sx:{width:"100%",height:10,borderRadius:5,"& .MuiLinearProgress-bar":{backgroundColor:n||""},...a},variant:"determinate",value:l>100?100:l})})}),d?(0,r.jsx)(t.Z,{children:(0,r.jsx)(s.Z,{variant:"body2",children:"".concat(Math.round(l),"%")})}):null]})}},30509:function(e,l,n){"use strict";var r=n(85893),t=n(67294),i=n(31002),s=n(29676),o=n(40044),d=n(30925),a=n(27709),c=n(11163);l.Z=e=>{var l;let{tabs:n,components:u,icons:h,children:x,onTabChange:m,forceScroll:v,orientation:p="horizontal",iconsOnly:g,queryKey:j="t",clearOnChange:Z=[],disableQuery:b=!1}=e,f=(0,i.Z)(e=>e.breakpoints.down("md"),{noSsr:!0}),y=(0,c.useRouter)(),[w,S]=(0,t.useState)(0),C=y.query[j],M=n.findIndex(e=>e===C),E=b?w:M>=0?M:0;(0,t.useEffect)(()=>{b||C||y.replace({pathname:y.pathname,query:{...y.query,[j]:n[E]}},void 0,{shallow:!0})},[C,j,n,E,y,b]);let G=Array.isArray(x)?x:[x];return(0,r.jsxs)(a.Z,{sx:"vertical"===p?{flexGrow:1,display:"flex"}:{},children:[(0,r.jsx)(s.Z,{centered:!v&&(!f||f&&n.length<4),scrollButtons:!0,allowScrollButtonsMobile:!0,sx:{marginBottom:3},variant:f&&n.length>=4||v?"scrollable":"standard",value:E,onChange:(e,l)=>{if(b)S(l);else{let e={...y.query,[j]:n[l]};Z.forEach(l=>delete e[l]),y.push({pathname:y.pathname,query:e},void 0,{shallow:!0})}m&&m(l)},children:null===(l=null!=u?u:n)||void 0===l?void 0:l.map((e,l)=>(0,r.jsx)(o.Z,{iconPosition:"start",icon:(null==h?void 0:h[l])?(0,r.jsx)("img",{src:"".concat(d.prefix).concat(null==h?void 0:h[l],".png")}):null,wrapped:!0,label:g?"":e,sx:{minWidth:62}},"".concat(null==e?void 0:e[l],"-").concat(l)))}),m?x:null==G?void 0:G.map((e,l)=>l===E?e:null)]})}},33190:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return guild}});var r=n(85893),t=n(2962),i=n(23972),s=n(51233),o=n(69417),d=n(66242),a=n(44267),c=n(67294),u=n(21480),h=n(30509),x=n(72882),m=n(55113),v=n(7906),p=n(53184),g=n(53816),j=n(53252),Z=n(26280),b=n(295),f=n(30925),y=n(27709),w=n(40929),Guild_GuildMembers=e=>{let{members:l,saves:n}=e,[t,s]=(0,c.useState)(),[o,d]=(0,c.useState)("desc"),[a,u]=(0,c.useState)("gpEarned"),h=null==n?void 0:n.slice().sort((e,l)=>l.timestamp-e.timestamp);(0,c.useEffect)(()=>{s(getSortedMembers(l,a,o))},[l]);let getSortedMembers=(e,l,n)=>[...e||[]].sort((e,r)=>"asc"===n?(null==e?void 0:e[l])-(null==r?void 0:r[l]):(null==r?void 0:r[l])-(null==e?void 0:e[l])),handleSort=(e,n)=>{d(n),u(e);let r=getSortedMembers(l,e,n);s(r)};return(0,r.jsx)(x.Z,{component:m.Z,children:(0,r.jsxs)(v.Z,{children:[(0,r.jsxs)(p.Z,{children:[(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(j.Z,{children:"Name"}),(0,r.jsx)(j.Z,{sortDirection:o,children:(0,r.jsx)(Z.Z,{direction:o,active:"level"===a,onClick:()=>handleSort("level","asc"===o?"desc":"asc"),children:"Level"})}),(0,r.jsx)(j.Z,{sortDirection:o,align:(null==n?void 0:n.length)===0?"left":"center",colSpan:(null==n?void 0:n.length)||1,children:(0,r.jsx)(Z.Z,{direction:o,active:"gpEarned"===a,onClick:()=>handleSort("gpEarned","asc"===o?"desc":"asc"),children:"Earned GP"})}),(0,r.jsx)(j.Z,{children:"Wanted Bonus"})]}),(null==h?void 0:h.length)>0?(0,r.jsxs)(g.Z,{children:[(0,r.jsx)(j.Z,{colSpan:2}),null==h?void 0:h.map((e,l)=>{if(e)return(0,r.jsx)(j.Z,{children:(0,w.Z)(null==e?void 0:e.timestamp,"dd/MM/yyyy HH:mm:ss")},"save"+l)}),(0,r.jsx)(j.Z,{})]}):null]}),(0,r.jsx)(b.Z,{children:null==t?void 0:t.map((e,l)=>{let{name:t,level:s,gpEarned:o,wantedBonus:d,rank:a}=e,c=null==n?void 0:n.reduce((e,l)=>{var n;let r=null==l?void 0:null===(n=l.members)||void 0===n?void 0:n.find(e=>{let{name:l}=e;return l===t});return[...e,{gpChange:r?o-(null==r?void 0:r.gpEarned):o,timestamp:null==l?void 0:l.timestamp}]},[]);return t?(0,r.jsxs)(g.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,r.jsxs)(j.Z,{children:[a<5?(0,r.jsx)("img",{src:"".concat(f.prefix,"etc/GuildRank").concat(a,".png"),alt:"rank-".concat(a)}):(0,r.jsx)(y.Z,{component:"span",sx:{display:"inline-block",width:15,height:17}}),(0,r.jsxs)(i.Z,{component:"span",sx:{ml:1},children:[t," ",0===a?"(King)":1===a?"(Leader)":""]})]}),(0,r.jsx)(j.Z,{children:s}),(null==n?void 0:n.length)===0?(0,r.jsx)(j.Z,{children:o}):null,c.map((e,l)=>{let{gpChange:n}=e;return(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(i.Z,{component:"span",mr:1,children:o}),(0,r.jsxs)(i.Z,{variant:"caption",color:n>0?"success.light":"error.light",children:["(",n>0?"+":"",n,")"]})]},"change"+l)}),(0,r.jsx)(j.Z,{children:(0,f.cleanUnderscore)(null==d?void 0:d.name)||"Guild Gifts"})]},t+s+l):null})})]})})},Guild_GuildBonuses=e=>{let{bonuses:l}=e,getCostToMax=e=>{let{maxLevel:l,level:n,gpBaseCost:r,gpIncrease:t}=e,i=0;for(let e=n;e<l;e++)i+=r+e*t;return i};return(0,r.jsx)(s.Z,{direction:"row",flexWrap:"wrap",gap:2,children:null==l?void 0:l.map((e,l)=>{let{name:n,level:t,gpIncrease:o,maxLevel:c,bonus:u,func:h,x1:x,x2:m,gpBaseCost:v}=e,p=getCostToMax(e);return(0,r.jsx)(d.Z,{sx:{width:300},children:(0,r.jsx)(a.Z,{children:(0,r.jsxs)(s.Z,{gap:2,children:[(0,r.jsxs)(s.Z,{direction:"row",alignItems:"center",gap:2,children:[(0,r.jsx)("img",{src:"".concat(f.prefix,"data/Gbonus").concat(l,".png"),alt:""}),(0,r.jsx)(i.Z,{children:(0,f.cleanUnderscore)(n)})]}),(0,r.jsxs)(s.Z,{gap:1,children:[(0,r.jsxs)(i.Z,{children:["level: ",t," / ",c]}),(0,r.jsxs)(i.Z,{children:["Cost: ",(0,f.notateNumber)(v+t*o)]}),(0,r.jsxs)(i.Z,{children:["Cost To Max: ",(0,f.notateNumber)(p)]}),(0,r.jsx)(i.Z,{sx:{fontSize:16},children:(0,f.cleanUnderscore)(u.replace("{",(0,f.growth)(h,t,x,m)))})]})]})})},n+l)})})},S=n(89309),C=n(18747);let CardTitleAndValue=e=>{let{cardSx:l,title:n,value:t,children:s}=e;return(0,r.jsx)(d.Z,{sx:{my:{xs:0,md:3},width:"fit-content",...l},children:(0,r.jsxs)(a.Z,{children:[(0,r.jsx)(i.Z,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,children:n}),t?(0,r.jsx)(i.Z,{children:t}):s]})})};var guild=()=>{var e,l,n,d,a,x,m,v;let{state:p}=(0,c.useContext)(u.I),{guild:g}=(null==p?void 0:p.account)||{},[j,Z]=(0,c.useState)([]),[b,M]=c.useState(null),[E,G]=(0,c.useState)("");(0,c.useEffect)(()=>{let e=(0,f.tryToParse)(localStorage.getItem("guild"));e&&Z(Array.isArray(e)?e:[e])},[]);let exportToJson=async e=>{M(e.currentTarget);try{var l;let e={date:(0,w.Z)(new Date,"dd/MM/yyyy HH:mm:ss"),members:null==g?void 0:null===(l=g.members)||void 0===l?void 0:l.map(e=>{let{name:l,gpEarned:n}=e;return{name:l,gpEarned:n}})};await navigator.clipboard.writeText(JSON.stringify(e,null,2))}catch(e){console.error("exportToJson -> ",e)}};return g&&(null==g?void 0:null===(e=g.members)||void 0===e?void 0:e.length)!==0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.PB,{title:"Guild | Idleon Toolbox",description:"Keep track of your guild members, gp, bonuses and more"}),(0,r.jsxs)(s.Z,{children:[(0,r.jsxs)(s.Z,{direction:"row",alignItems:"center",gap:1,children:[(0,r.jsx)("img",{src:"".concat(f.prefix,"data/G2icon").concat(null==p?void 0:null===(n=p.account)||void 0===n?void 0:null===(l=n.accountOptions)||void 0===l?void 0:l[38],".png"),alt:"guild-icon"}),(0,r.jsxs)(i.Z,{variant:"h3",children:[null==p?void 0:null===(a=p.account)||void 0===a?void 0:null===(d=a.accountOptions)||void 0===d?void 0:d[37]," ",(0,r.jsxs)(i.Z,{component:"span",variant:"h5",children:["(",null==g?void 0:null===(x=g.members)||void 0===x?void 0:x.length," / ",null==g?void 0:g.maxMembers,")"]})]})]}),(0,r.jsxs)(s.Z,{sx:{mb:1},direction:"row",gap:2,flexWrap:"wrap",children:[(0,r.jsx)(CardTitleAndValue,{title:"Members",value:"".concat(null==g?void 0:null===(m=g.members)||void 0===m?void 0:m.length," / ").concat(null==g?void 0:g.maxMembers)}),(0,r.jsxs)(CardTitleAndValue,{title:"Exp",children:[(0,r.jsx)(S.Z,{boxSx:{width:200},percent:(null==g?void 0:g.totalGp)/Math.round(null==g?void 0:g.levelReq)*100,bgColor:"#f3dd4c"}),(0,r.jsxs)(i.Z,{children:[(0,f.numberWithCommas)(null==g?void 0:g.totalGp)," / ",(0,f.numberWithCommas)(Math.round(null==g?void 0:g.levelReq))]})]}),(0,r.jsx)(CardTitleAndValue,{title:"Saves (up to 3)",children:(0,r.jsxs)(s.Z,{gap:1,children:[(0,r.jsx)(y.Z,{children:null==j?void 0:null===(v=j.reverse())||void 0===v?void 0:v.map((e,l)=>{let{timestamp:n}=e;return(0,r.jsxs)(i.Z,{children:["#",l+1," - ",(0,w.Z)(new Date(n),"dd/MM/yyyy HH:mm:ss")]},n+l)})}),(0,r.jsxs)(s.Z,{direction:"row",alignItems:"center",gap:2,children:[(0,r.jsx)(o.Z,{variant:"contained",onClick:()=>{let e;let l=new Date().getTime(),n=(0,f.tryToParse)(localStorage.getItem("guild"));Z(e=Array.isArray(n)?[...(n=(null==n?void 0:n.length)>=3?null==n?void 0:n.slice(1):n)||[],{timestamp:l,members:null==g?void 0:g.members}]:n?[n,{timestamp:l,members:null==g?void 0:g.members}]:[{timestamp:l,members:null==g?void 0:g.members}]),localStorage.setItem("guild",JSON.stringify(e)),G("")},children:"Save"}),(0,r.jsx)(o.Z,{variant:"contained",onClick:exportToJson,children:"Export"}),(0,r.jsx)(C.Z,{anchorEl:b,handleClose:()=>M(null)}),(0,r.jsx)(o.Z,{variant:"contained",color:"warning",onClick:()=>{localStorage.removeItem("guild"),Z([])},children:"Clear all"})]}),E?(0,r.jsx)(i.Z,{color:"error.light",children:E}):null]})})]})]}),(0,r.jsxs)(h.Z,{tabs:["Members","Bonuses"],children:[(0,r.jsx)(Guild_GuildMembers,{members:null==g?void 0:g.members,saves:j}),(0,r.jsx)(Guild_GuildBonuses,{bonuses:null==g?void 0:g.guildBonuses})]})]}):(0,r.jsx)(i.Z,{variant:"h3",mb:3,children:"You have to be in a guild to view this page's content"})}}},function(e){e.O(0,[4411,1367,9774,2888,179],function(){return e(e.s=19920)}),_N_E=e.O()}]);