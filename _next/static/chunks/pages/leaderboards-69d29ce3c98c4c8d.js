(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5983],{18131:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/leaderboards",function(){return n(15362)}])},30509:function(e,r,n){"use strict";var a=n(85893),t=n(67294),l=n(31002),i=n(29676),o=n(40044),d=n(30925),s=n(27709),c=n(11163);r.Z=e=>{var r;let{tabs:n,components:u,icons:h,children:x,onTabChange:p,forceScroll:g,orientation:m="horizontal",iconsOnly:v,queryKey:b="t",clearOnChange:f=[],disableQuery:j=!1}=e,C=(0,l.Z)(e=>e.breakpoints.down("md"),{noSsr:!0}),Z=(0,c.useRouter)(),[y,w]=(0,t.useState)(0),S=Z.query[b],L=n.findIndex(e=>e===S),_=j?y:L>=0?L:0;(0,t.useEffect)(()=>{j||S||Z.replace({pathname:Z.pathname,query:{...Z.query,[b]:n[_]}},void 0,{shallow:!0})},[S,b,n,_,Z,j]);let k=Array.isArray(x)?x:[x];return(0,a.jsxs)(s.Z,{sx:"vertical"===m?{flexGrow:1,display:"flex"}:{},children:[(0,a.jsx)(i.Z,{centered:!g&&(!C||C&&n.length<4),scrollButtons:!0,allowScrollButtonsMobile:!0,sx:{marginBottom:3},variant:C&&n.length>=4||g?"scrollable":"standard",value:_,onChange:(e,r)=>{if(j)w(r);else{let e={...Z.query,[b]:n[r]};f.forEach(r=>delete e[r]),Z.push({pathname:Z.pathname,query:e},void 0,{shallow:!0})}p&&p(r)},children:null===(r=null!=u?u:n)||void 0===r?void 0:r.map((e,r)=>(0,a.jsx)(o.Z,{iconPosition:"start",icon:(null==h?void 0:h[r])?(0,a.jsx)("img",{src:"".concat(d.prefix).concat(null==h?void 0:h[r],".png")}):null,wrapped:!0,label:v?"":e,sx:{minWidth:62}},"".concat(null==e?void 0:e[r],"-").concat(r)))}),p?x:null==k?void 0:k.map((e,r)=>r===_?e:null)]})}},15362:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return leaderboards}});var a=n(85893),t=n(31002),l=n(50135),i=n(87109),o=n(93946),d=n(18979),s=n(51233),c=n(67720),u=n(23972),h=n(98456),x=n(30509),p=n(82729),g=n(67294),m=n(18843),v=n(97212),b=n(98619),f=n(23795),j=n(48885),C=n(59334),Z=n(40360),y=n(30925),w=n(27709),S=n(61599);function _templateObject(){let e=(0,p._)(["\n  display: ",";\n  align-items: center;\n  justify-content: center;\n  background-color: ",";\n  border-radius: 50%;\n  width: 24px;\n  height: 24px;\n"]);return _templateObject=function(){return e},e}let specialNotation=(e,r)=>"bits"===e?(0,y.notateNumber)(r,"bits"):"dropRate"===e?(0,y.notateNumber)(r,"MultiplierInfo"):(0,y.notateNumber)(r),L=(0,S.Z)(w.Z,{shouldForwardProp:e=>"inline"!==e})(_templateObject(),e=>{let{inline:r}=e;return r?"inline-flex":"flex"},e=>{let{bgColor:r}=e;return r||"#ffffff21"});var Leaderboard=e=>{let{leaderboards:r,loggedMainChar:n,searchedChar:t}=e;return(0,a.jsx)(Z.Z,{sx:{width:"100%",margin:"0 auto",justifyContent:"center"},container:!0,rowSpacing:3,columnSpacing:{xs:1,xl:2},children:Object.entries(r||{}).map((e,r)=>{var l;let[i,o]=e,d={},s=o.map((e,r)=>{let a=e.mainChar,l=a===t;return l&&r>=10&&(d[a]=null==e?void 0:e.rank),{...e,...a===n&&{loggedMainChar:!0},...l&&{searchedChar:!0},index:r+1}}),h=null===(l=Object.entries(d))||void 0===l?void 0:l.map(e=>{let[r,a]=e,t=null==o?void 0:o.find(e=>(null==e?void 0:e.mainChar)===r),l=t.mainChar===n?"loggedMainChar":"searchedChar";return{...t,[l]:!0,index:a}},[]),x=null==s?void 0:s.slice(0,10).concat(h),p=(null==o?void 0:o.length)===0;return(0,a.jsxs)(w.Z,{sx:{display:"grid","--auto-grid-min-size":"18rem",gridTemplateColumns:"repeat(auto-fill, minmax(var(--auto-grid-min-size), 1fr))",alignSelf:"flex-start",gap:"1rem"},children:[(0,a.jsx)(u.Z,{textAlign:"center",variant:"h5",mt:{xs:3,lg:0},mb:{xs:3,lg:1},children:i.camelToTitleCase()}),p?(0,a.jsx)(u.Z,{textAlign:"center",mt:5,variant:"h6",children:"Nothing here yet"}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(m.Z,{dense:!0,disablePadding:!0,children:x.map((e,r)=>{let n=(null==e?void 0:e[i])||0,t=0===r?"data/Trophie.png":1===r?"data/G2icon40.png":2===r?"data/G2icon39.png":"";return(0,a.jsxs)(g.Fragment,{children:[(0,a.jsx)(v.ZP,{disablePadding:!0,sx:{borderRadius:0===r?"8px 8px 0 0":r===x.length-1?"0 0 8px 8px":"","&:hover":{borderRadius:0===r?"8px 8px 0 0":r===x.length-1?"0 0 8px 8px":""},backgroundColor:(null==e?void 0:e.loggedMainChar)||(null==e?void 0:e.searchedChar)?"#12141c":"#1e262e",border:(null==e?void 0:e.loggedMainChar)||(null==e?void 0:e.searchedChar)?"2px solid":"none",borderColor:(null==e?void 0:e.loggedMainChar)?"#007E85":(null==e?void 0:e.searchedChar)?"#cd861b":""},secondaryAction:(0,a.jsx)(u.Z,{sx:{pr:2},variant:"body2",children:specialNotation(i,n)}),children:(0,a.jsxs)(b.Z,{component:f.Z,target:"_blank",href:"https://idleontoolbox.com?profile=".concat(null==e?void 0:e.mainChar),disableGutters:!0,sx:{pl:2,py:.5,borderRadius:"inherit"},children:[(0,a.jsx)(j.Z,{children:t?(0,a.jsx)("img",{width:24,height:24,style:{objectFit:"contain"},src:"".concat(y.prefix).concat(t),alt:""}):(0,a.jsx)(L,{inline:!0,children:(0,a.jsx)(u.Z,{variant:"body2",children:(null==e?void 0:e.index)?null==e?void 0:e.index:r+4})})}),(0,a.jsx)(C.Z,{primary:null==e?void 0:e.mainChar,slotProps:{primary:{variant:"body1"}}})]})}),r<x.length-1?(0,a.jsx)(c.Z,{component:"li"}):null]},"".concat(i,"-").concat(r))})})})]},"".concat(i,"-").concat(r))})})},_=n(21480),k=n(2962),M=n(94967),A=n(13129),E=n(11163),N=n(40929);let U=["General","Tasks","Skills","Character","Misc","Caverns"];var leaderboards=()=>{var e,r;let{state:n}=(0,g.useContext)(_.I),p=(0,t.Z)(e=>e.breakpoints.down("sm"),{noSsr:!0}),m=null==n?void 0:null===(r=n.characters)||void 0===r?void 0:null===(e=r[0])||void 0===e?void 0:e.name,[v,b]=(0,g.useState)(null),[f,j]=g.useState(""),[C,Z]=(0,g.useState)(""),S=(0,E.useRouter)(),{t:L}=S.query,[P,T]=(0,g.useState)((null==L?void 0:L.toLowerCase())||"general"),[I,O]=(0,g.useState)(!1),[z,F]=(0,g.useState)("");(0,g.useEffect)(()=>{let getLeaderboards=async()=>{try{let e=await (0,M.$E)(P.toLowerCase());b(e),j("")}catch(e){j("Error has occurred while getting leaderboards")}};getLeaderboards()},[P]);let isUserFullyExistLocally=(e,r)=>{for(let n in e)if(!e[n].some(e=>e.mainChar===r))return!1;return!0},searchUserAndAppend=(e,r,n)=>{for(let a in e){let t=e[a],l=t.some(e=>e.mainChar===r);l||(void 0!==n[a]?e[a].push({mainChar:r,...n[a]}):e[a].push({mainChar:r}))}return e},handleUserSearch=async()=>{if(!C)return;let e=isUserFullyExistLocally(v[P.toLowerCase()],C);if(!e){O(!0);let e=await (0,M.nC)(P.toLowerCase(),C);if(!e||(null==e?void 0:e.error))return O(!1),F(null==e?void 0:e.error);let r=searchUserAndAppend(v[P.toLowerCase()],C,e);b({...v,[P.toLowerCase()]:r}),O(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.PB,{title:"Leaderboards | Idleon Toolbox",description:"Leaderboards for Legends Of Idleon MMO"}),(0,a.jsx)(w.Z,{sx:{maxWidth:"300px",margin:"16px auto",border:"none"},children:(0,a.jsx)(l.Z,{fullWidth:!0,size:"small",value:C||"",label:p?"Char name":"Character name",onChange:e=>{Z(e.target.value),F("")},onKeyDown:e=>{C&&!I&&"Enter"===e.key&&handleUserSearch()},slotProps:{input:{endAdornment:(0,a.jsx)(i.Z,{position:"end",children:(0,a.jsx)(o.Z,{loading:I,disabled:!(null==v?void 0:v.totalUsers)||I,onClick:handleUserSearch,children:(0,a.jsx)(A.Z,{})})})}},error:""!==z,helperText:z})}),(0,a.jsx)(w.Z,{sx:{maxWidth:"300px",margin:"16px auto",textAlign:"center"},children:(null==v?void 0:v.totalUsers)&&(null==v?void 0:v.createdAt)?(0,a.jsxs)(s.Z,{direction:"row",gap:1,justifyContent:"center",divider:(0,a.jsx)(c.Z,{flexItem:!0,sx:{bgcolor:"#a9b3a6"},orientation:"vertical"}),children:[(0,a.jsxs)(s.Z,{flexWrap:"wrap",direction:"row",gap:1,justifyContent:"center",alignItems:"center",children:[(0,a.jsx)(u.Z,{sx:{fontSize:14},component:"div",children:(0,y.numberWithCommas)(null==v?void 0:v.totalUsers)}),(0,a.jsx)(u.Z,{sx:{fontSize:14},children:"Accounts"})]}),(0,a.jsxs)(s.Z,{flexWrap:"wrap",direction:"row",gap:1,justifyContent:"center",alignItems:"center",children:[(0,a.jsx)(u.Z,{sx:{fontSize:14},children:"Updated at"}),(0,a.jsx)(u.Z,{sx:{fontSize:14},component:"div",children:(0,N.Z)(null==v?void 0:v.createdAt,"HH:mm:ss")})]})]}):(0,a.jsx)(d.Z,{sx:{width:300,margin:"0 auto"},variant:"text"})}),(0,a.jsxs)(x.Z,{tabs:U,onTabChange:e=>{T(null==U?void 0:U[e]),b(null),j("")},children:[(0,a.jsx)(Leaderboard,{leaderboards:null==v?void 0:v.general,loggedMainChar:m,searchedChar:C}),(0,a.jsx)(Leaderboard,{leaderboards:null==v?void 0:v.tasks,loggedMainChar:m,searchedChar:C}),(0,a.jsx)(Leaderboard,{leaderboards:null==v?void 0:v.skills,loggedMainChar:m,searchedChar:C}),(0,a.jsx)(Leaderboard,{leaderboards:null==v?void 0:v.character,loggedMainChar:m,searchedChar:C}),(0,a.jsx)(Leaderboard,{leaderboards:null==v?void 0:v.misc,loggedMainChar:m,searchedChar:C}),(0,a.jsx)(Leaderboard,{leaderboards:null==v?void 0:v.caverns,loggedMainChar:m,searchedChar:C})]}),v||f?f?(0,a.jsx)(u.Z,{color:"error.light",textAlign:"center",variant:"h6",children:f}):null:(0,a.jsx)(s.Z,{alignItems:"center",justifyContent:"center",mt:3,children:(0,a.jsx)(h.Z,{})})]})}}},function(e){e.O(0,[433,9774,2888,179],function(){return e(e.s=18131)}),_N_E=e.O()}]);