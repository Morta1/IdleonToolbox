(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6080],{36549:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/statistics",function(){return o(57371)}])},57371:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return statistics}});var i=o(85893),r=o(2962),l=o(67294),n=o(88479),a=o(31002),s=o(86886),d=o(70473),c=o(30925),f=o(88054);let u={background:"transparent",textColor:"#c9c9c9",fontSize:14,fontFamily:"system-ui, -apple-system, sans-serif",axis:{domain:{line:{stroke:"#424242",strokeWidth:1}},legend:{text:{fill:"#ffffff",fontWeight:600,fontSize:14}},ticks:{line:{stroke:"#424242",strokeWidth:1},text:{fill:"#c9c9c9",fontWeight:500,fontSize:12}}},grid:{line:{stroke:"#2f3641",strokeWidth:1}},legends:{text:{fill:"#ffffff",fontWeight:500}},tooltip:{container:{background:"#1C252E",color:"#c9c9c9",fontWeight:500,fontSize:14,borderRadius:8,boxShadow:"rgba(0, 0, 0, 0.05) 0px 1px 3px 0px, rgba(0, 0, 0, 0.05) 0px 20px 25px -5px, rgba(0, 0, 0, 0.04) 0px 10px 10px",border:"1px solid #424242",padding:8}},labels:{text:{fill:"#ffffff",fontWeight:600,fontSize:12}},annotations:{text:{fill:"#c9c9c9",fontWeight:500},link:{stroke:"#424242",strokeWidth:1},outline:{stroke:"#2f3641",strokeWidth:2}},dots:{text:{fill:"#ffffff",fontWeight:500}},crosshair:{line:{stroke:"#424242",strokeWidth:1,strokeOpacity:.75}}},p=["#2087e8","#94baee","#48BB78","#ED8936","#9F7AEA","#38B2AC","#ECC94B","#F56565","#68D391","#63B3ED"],getVisualizationMap=e=>({totalLevels:{type:"bar",props:{},getData:e=>e.filter((e,t)=>{let{count:o}=e;return t>4&&o>50})},worldDistribution:{type:"bar",getData:e=>e.toSorted((e,t)=>t.count-e.count)},topBubbles:{type:"bar",props:{valueFormat:e=>(0,c.notateNumber)(e),margin:{left:130,right:60},axisBottom:{legend:"Levels",format:e=>(0,c.notateNumber)(e)},axisLeft:{legendOffset:0,legend:""}},getData:e=>e.map(e=>{let{bubbleIndex:t,cauldronIndex:o,value:i}=e,r=null===d.cauldrons||void 0===d.cauldrons?void 0:d.cauldrons[f.D6[o]],l=null==r?void 0:r[t],n=(0,c.cleanUnderscore)(null==l?void 0:l.bubbleName).toLowerCase().capitalizeAll();return{_id:n,count:i}}).toSorted((e,t)=>e.count-t.count)},classDistribution:{type:"pie",getData:t=>t.filter(e=>{let{count:t}=e;return t>70}).map(t=>({...t,_id:(0,c.cleanUnderscore)(null==e?void 0:e[null==t?void 0:t._id])})).toSorted((e,t)=>t.count-e.count)},accountAge:{type:"bar",props:{axisLeft:{legend:"Account Age (years)"}},getData:e=>e.toSorted((e,t)=>t.count-e.count)},topKilledMonsters:{type:"bar",props:{enableTotals:!0,enableLabel:!1,valueFormat:e=>(0,c.notateNumber)(e,"Big"),margin:{left:130,right:60},axisLeft:{legendOffset:0,legend:""},axisBottom:{format:e=>(0,c.notateNumber)(e)}},getData:e=>e.map(e=>{let{enemy:t,kills:o}=e;return{_id:(0,c.cleanUnderscore)(t),count:o}}).toSorted((e,t)=>e.count-t.count)}});var g=o(73049),b=o(23972),statistics_BarVisualization=e=>{let{data:t,indexKey:o,keys:r,label:l,color:n,layout:a="horizontal",axisBottom:s,axisLeft:d,valueFormat:c,margin:f,enableTotals:p,enableLabel:x}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Z,{children:l}),(0,i.jsx)(g.jM,{data:t,keys:["count"],indexBy:o,margin:{top:30,right:30,bottom:60,left:70,...f},padding:.3,borderRadius:4,layout:a,enableTotals:p,enableLabel:x,axisBottom:{legend:"Players",legendPosition:"middle",legendOffset:45,...s},axisLeft:{legend:l,legendPosition:"middle",legendOffset:-50,...d},valueFormat:c||null,colors:n,animate:!0,motionConfig:"gentle",theme:u,labelTextColor:"#ffffff",enableGridX:!1,enableGridY:!0,borderColor:{from:"color",modifiers:[["darker",.3]]},defs:[{id:"gradientA",type:"linearGradient",colors:[{offset:0,color:"inherit"},{offset:100,color:"inherit",opacity:.8}]}],fill:[{match:"*",id:"gradientA"}]})]})},x=o(50751),statistics_PieVisualization=e=>{let{data:t,label:o,colors:r,legends:l,isMd:n}=e;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(b.Z,{children:o}),(0,i.jsx)(x.Y2,{data:t,margin:{top:30,right:30,bottom:60,left:30},innerRadius:.5,padAngle:1.5,cornerRadius:4,colors:r,borderWidth:1,borderColor:{from:"color",modifiers:[["darker",.2]]},theme:u,enableArcLabels:!0,arcLabelsTextColor:"#fff",arcLinkLabelsTextColor:"#fff",arcLinkLabelsThickness:2,arcLabelsSkipAngle:10,arcLinkLabelsSkipAngle:10,arcLinkLabelsColor:{from:"color"},activeOuterRadiusOffset:4,tooltip:e=>{let{datum:t}=e;return(0,i.jsxs)("div",{style:{color:"#fff",background:"#1C252E",padding:8,borderRadius:8,border:"1px solid #424242",minWidth:120},children:[(0,i.jsx)("strong",{children:t.label}),": ",t.value]})},legends:n?[]:l})]})},statistics=()=>{let[e,t]=(0,l.useState)(null),[o,c]=(0,l.useState)(!0),[f,u]=(0,l.useState)(null),g=(0,a.Z)(e=>e.breakpoints.down("lg"),{noSsr:!0}),b=getVisualizationMap(d.classes);return((0,l.useEffect)(()=>{fetch("".concat("https://profiles.idleontoolbox.workers.dev/api","/visualizations")).then(e=>{if(!e.ok)throw Error("Failed to fetch");return e.json()}).then(e=>{t(e),c(!1)}).catch(e=>{u(e.message),c(!1)})},[]),o)?(0,i.jsx)(n.Z,{message:"Loading visualizations..."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.PB,{title:"Statistics | Idleon Toolbox",description:"Statistics page for various aspects of the game"}),(0,i.jsxs)("div",{style:{background:"#141A21",minHeight:"100vh",padding:20},children:[f&&(0,i.jsxs)("p",{style:{color:"#F56565",textAlign:"center",fontSize:14},children:["Error: ",f]}),!o&&!f&&e&&(0,i.jsx)(s.ZP,{container:!0,spacing:3,children:(e?Object.entries(e).filter(e=>{let[t]=e;return b[t]&&b[t].getData}).map((e,t)=>{let[o,r]=e,l=b[o],n=l.type,a=l.getData(r);if(!Array.isArray(a))return null;let s=a[0]||{},d=Object.keys(s).find(e=>"count"!==e)||"id";if("bar"===n){var c;return(0,i.jsx)(statistics_BarVisualization,{keys:o,data:a.map(e=>({[d]:e[d],count:e.count})),indexKey:d,label:(null==l?void 0:null===(c=l.props)||void 0===c?void 0:c.label)||o.camelToTitleCase(),color:p[t%p.length],...null==l?void 0:l.props},o)}if("pie"===n){let e=a.map(e=>({id:e._id,value:e.count,label:e[d],color:p[t%p.length]}));return(0,i.jsx)(statistics_PieVisualization,{data:e,label:o.camelToTitleCase(),colors:p,legends:[{anchor:"top-left",direction:"column",itemHeight:18,symbolShape:"circle"}],isMd:g,...null==l?void 0:l.props},o)}return null}):null).map((e,t)=>(0,i.jsx)(s.ZP,{item:!0,xs:12,md:6,children:(0,i.jsx)("div",{style:{flex:1,height:400,minWidth:300,background:"#1C252E",borderRadius:8,padding:32,border:"1px solid #424242",boxShadow:"rgba(0, 0, 0, 0.05) 0px 1px 3px 0px, rgba(0, 0, 0, 0.05) 0px 20px 25px -5px, rgba(0, 0, 0, 0.04) 0px 10px 10px"},children:e})},t))})]})]})}}},function(e){e.O(0,[6886,124,9774,2888,179],function(){return e(e.s=36549)}),_N_E=e.O()}]);