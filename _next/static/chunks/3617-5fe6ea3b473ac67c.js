"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3617],{55407:function(e,t,n){var a=n(85893),r=n(67294),l=n(23972),s=n(67720),c=n(51233),i=n(94054),o=n(47312),d=n(53213),h=n(18972),u=n(69417),x=n(591),p=n(47120),g=n(50657),m=n(37645),j=n(6514),v=n(50135),Z=n(66242),f=n(44267),C=n(27709),b=n(72882),y=n(55113),w=n(7906),k=n(53184),S=n(53816),I=n(53252),L=n(295),M=n(30925),q=n(76947),O=n(95605),z=n(29540),N=n(2511),U=n(62801),P=n(7336);let E=[5,10,25,50,100,200,300];t.Z=e=>{let{character:t,account:n,getOptimizedUpgradesFn:_,upgradeCategories:A,resourceNames:R,resourceKey:T,resourceImagePrefix:B,upgradeImagePrefix:F,getResourceType:V,getUpgradeIconIndex:G,getResourceAmount:H,tooltipText:W}=e,[D,$]=(0,P.I)({key:"".concat(T,":genericUpgradeOptimizer:viewMode"),defaultValue:"grid"}),[K,Q]=(0,P.I)({key:"".concat(T,":genericUpgradeOptimizer:category"),defaultValue:"damage"}),[X,J]=(0,P.I)({key:"".concat(T,":genericUpgradeOptimizer:maxUpgrades"),defaultValue:10}),[Y,ee]=(0,U.Z)("Group by upgrade"),[et,en]=(0,U.Z)("Only show affordable upgrades"),[ea,er]=(0,P.I)({key:"".concat(T,":genericUpgradeOptimizer:resourcePerHour"),defaultValue:(()=>{let e={};return Object.keys(R).forEach(t=>{e[t]=1}),e})()}),[el,es]=(0,r.useState)(()=>{let e={};return Object.keys(R).forEach(t=>{e[t]=void 0!==ea[t]&&null!==ea[t]&&""!==ea[t]?ea[t].toLocaleString():""}),e}),[ec,ei]=(0,r.useState)(!1),[eo,ed]=(0,P.I)({key:"".concat(T,":genericUpgradeOptimizer:optimizationMethod"),defaultValue:"rph"});(0,r.useEffect)(()=>{es(Object.fromEntries(Object.entries(ea).map(e=>{let[t,n]=e;return[t,null!=n&&""!==n?Number(n).toLocaleString():""]})))},[ea]);let eh=(0,r.useMemo)(()=>t?_(t,n,K,X,{onlyAffordable:en,resourcePerHour:"rph"===eo?ea:void 0,getResourceType:V}):[],[t,K,X,n,_,en,ea,eo,V]),eu=(0,r.useMemo)(()=>{if(!ee)return eh.map((e,t)=>({...e,upgradeIndex:t}));let e=[],t=null,n={};return eh.forEach((a,r)=>{var l;let s=a.name,c=t&&t.name===s?t.startLevel:null!==(l=n[s])&&void 0!==l?l:a.level;t&&t.name===s?t.sequence.push({...a,originalIndex:r}):(t&&(t.finalLevel=t.startLevel+t.sequence.length-1,n[t.name]=t.finalLevel,e.push(t)),t={...a,upgradeIndex:r,sequence:[{...a,originalIndex:r}],startLevel:c})}),t&&(t.finalLevel=t.startLevel+t.sequence.length-1,n[t.name]=t.finalLevel,e.push(t)),e.map(e=>{if(!e.sequence||e.sequence.length<=1)return e;let t={},n=0,a=V(e);return e.sequence.forEach(e=>{n+=e.cost,"all"!==K&&e.statChanges.forEach(e=>{t[e.stat]||(t[e.stat]={stat:e.stat,change:0,percentChange:0}),t[e.stat].change+=e.change,t[e.stat].percentChange+=e.percentChange})}),{...e,combinedStatChanges:Object.values(t),totalCost:n,resourceType:a,startLevel:e.startLevel,finalLevel:e.finalLevel,numberOfUpgrades:e.sequence.length}})},[eh,ee,V]),ex=(0,r.useMemo)(()=>{let e={};eh.forEach(t=>{let n=V(t),a=R[n]||n;e[a]||(e[a]={name:a,cost:0,currentAmount:0}),e[a].cost+=t.cost});let t=T.split(".").reduce((e,t)=>null==e?void 0:e[t],n)||[];return t.forEach((t,n)=>{let a=R[n]||t.name;if(e[a]){var r;e[a].currentAmount=H?H(t,n,R):null!==(r=t.value)&&void 0!==r?r:t}}),Object.values(e)},[eh,n,T,R,H,V]),formatChange=e=>e>=1e3?"+".concat((0,M.notateNumber)(e)):"+".concat(e.toFixed(2).replace(/\.00$/,"")),formatPercentChange=e=>"+".concat(e.toFixed(2).replace(/\.00$/,""),"%"),renderStatChanges=e=>e.map((e,t)=>(0,a.jsxs)(l.Z,{variant:"body2",children:[e.stat.charAt(0).toUpperCase()+e.stat.slice(1),": ",formatChange(e.change)," (",formatPercentChange(e.percentChange),")"]},t)),renderCombinedStats=e=>{if(!e.combinedStatChanges)return null;let t=Object.keys(R).find(t=>R[t]===e.resourceType)||e.resourceType;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{sx:{my:1}}),(0,a.jsxs)(l.Z,{variant:"subtitle2",gutterBottom:!0,children:["Total Benefits (Levels ",e.startLevel," → ",e.finalLevel,")"]}),e.combinedStatChanges.map((e,t)=>(0,a.jsxs)(l.Z,{variant:"body2",children:[e.stat.charAt(0).toUpperCase()+e.stat.slice(1),": ",formatChange(e.change)," (",formatPercentChange(e.percentChange),")"]},t)),(0,a.jsx)(s.Z,{sx:{my:1}}),(0,a.jsxs)(c.Z,{direction:"row",gap:1,alignItems:"center",children:[(0,a.jsx)("img",{style:{objectPosition:"0 -6px"},src:"".concat(M.prefix,"data/").concat(B).concat(t,"_x1.png"),alt:""}),(0,a.jsxs)(l.Z,{variant:"body2",children:["Total Cost: ",(0,M.notateNumber)(e.totalCost)]})]})]})},handleRphDialogClose=()=>{Object.entries(el).forEach(e=>{let[t,n]=e,a=(n||"").replace(/\s+/g,""),r=(0,M.parseShorthandNumber)(a);""===a||isNaN(r)?(er(e=>({...e,[t]:""})),es(e=>({...e,[t]:""}))):(er(e=>({...e,[t]:r})),es(e=>({...e,[t]:String(r)})))}),ei(!1)};return(0,a.jsxs)(c.Z,{gap:3,children:[(0,a.jsxs)(c.Z,{direction:"row",gap:2,alignItems:"center",flexWrap:"wrap",children:[(0,a.jsxs)(i.Z,{size:"small",sx:{width:200},children:[(0,a.jsx)(o.Z,{children:"Optimization Category"}),(0,a.jsxs)(d.Z,{value:K,label:"Optimization Category",onChange:e=>Q(e.target.value),children:[Object.entries(A).map(e=>{let[t,{name:n}]=e;return(0,a.jsx)(h.Z,{value:t,children:n},t)}),(0,a.jsx)(h.Z,{value:"all",children:"All"})]})]}),(0,a.jsxs)(i.Z,{size:"small",sx:{width:180},children:[(0,a.jsx)(o.Z,{children:"Optimization Method"}),(0,a.jsxs)(d.Z,{value:eo,label:"Optimization Method",onChange:e=>ed(e.target.value),children:[(0,a.jsx)(h.Z,{value:"rph",children:"Resource per hour"}),(0,a.jsx)(h.Z,{value:"cost",children:"Cost only"})]})]}),"rph"===eo&&(0,a.jsx)(u.Z,{sx:{width:"fit-content"},variant:"outlined",onClick:()=>ei(!0),children:"Set RPH"}),(0,a.jsxs)(i.Z,{size:"small",sx:{width:120},children:[(0,a.jsx)(o.Z,{children:"Max Upgrades"}),(0,a.jsx)(d.Z,{value:X,label:"Max Upgrades",onChange:e=>J(e.target.value),children:E.map(e=>(0,a.jsx)(h.Z,{value:e,children:e},e))})]}),(0,a.jsx)(Y,{}),(0,a.jsx)(et,{}),(0,a.jsx)(N.Z,{title:W,children:(0,a.jsx)(q.Z,{})}),(0,a.jsx)(s.Z,{sx:{my:1},flexItem:!0,orientation:"vertical"}),ex.map(e=>{let t=Object.keys(R).find(t=>R[t]===e.name)||e.name;return(0,a.jsxs)(c.Z,{direction:"row",gap:1,alignItems:"center",children:[(0,a.jsx)("img",{style:{objectPosition:"0 -6px"},src:"".concat(M.prefix,"data/").concat(B).concat(t,"_x1.png"),alt:e.name,width:24,height:24}),(0,a.jsx)(l.Z,{children:(0,M.notateNumber)(e.cost)})]},e.name)}),(0,a.jsxs)(x.Z,{value:D,exclusive:!0,sx:{ml:"auto"},onChange:(e,t)=>t&&$(t),children:[(0,a.jsx)(N.Z,{title:"Grid view",children:(0,a.jsx)(p.Z,{sx:{height:40},value:"grid",children:(0,a.jsx)(O.Z,{})})}),(0,a.jsx)(N.Z,{title:"List view",children:(0,a.jsx)(p.Z,{sx:{height:40},value:"list",children:(0,a.jsx)(z.Z,{})})})]})]}),"rph"===eo&&(0,a.jsxs)(g.Z,{open:ec,onClose:handleRphDialogClose,children:[(0,a.jsx)(m.Z,{children:"Set Resource Per Hour"}),(0,a.jsxs)(j.Z,{children:[(0,a.jsx)(c.Z,{direction:"column",gap:2,children:Object.entries(R).map((e,t)=>{let[n,r]=e;return(0,a.jsxs)(c.Z,{direction:"column",children:[(0,a.jsxs)(l.Z,{variant:"caption",children:[r," per hour:"]}),(0,a.jsx)(v.Z,{InputProps:{startAdornment:(0,a.jsx)("img",{style:{objectPosition:"0 -3px",marginLeft:-5,marginRight:5},src:"".concat(M.prefix,"data/").concat(B).concat(t,"_x1.png"),width:24,height:24})},type:"text",size:"small",value:el[n],onChange:e=>{let t=e.target.value;/^[\d,\.kmbtqKMBTQ \u00A0\u2009\u202F]*$/.test(t)&&es(e=>({...e,[n]:t}))},onBlur:e=>{let t=e.target.value.replace(/\s+/g,""),a=(0,M.parseShorthandNumber)(t);""===t||isNaN(a)?(er(e=>({...e,[n]:""})),es(e=>({...e,[n]:""}))):(er(e=>({...e,[n]:a})),es(e=>({...e,[n]:String(a)})))},inputProps:{inputMode:"text",pattern:"[0-9.,kmbtqKMBTQ \xa0  ]*"}}),ea[n]&&!isNaN(ea[n])&&0!==ea[n]&&ea[n]>1e3?(0,a.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:(0,M.notateNumber)(ea[n])}):null]},n)})}),(0,a.jsx)(u.Z,{sx:{mt:2},onClick:handleRphDialogClose,variant:"contained",children:"Close"})]})]}),(0,a.jsx)(l.Z,{variant:"h6",children:"Recommended Upgrade Sequence"}),eu.length>0?"grid"===D?(0,a.jsx)(c.Z,{direction:"row",gap:2,flexWrap:"wrap",children:eu.map(e=>{let t=e.sequence&&e.sequence.length>1,n=e.upgradeIndex,r=V(e),i=G?G(e):e.index;return(0,a.jsx)(Z.Z,{sx:{width:350},children:(0,a.jsxs)(f.Z,{children:[(0,a.jsxs)(c.Z,{direction:"row",gap:2,sx:{position:"relative"},children:[(0,a.jsx)("img",{style:{width:32,height:32},src:"".concat(M.prefix,"data/").concat(F).concat(i,".png"),alt:""}),(0,a.jsxs)(C.Z,{children:[(0,a.jsxs)(l.Z,{variant:"subtitle1",children:[(0,M.cleanUnderscore)(e.name.replace(/[船般航舞製]/,"").replace("(Tap_for_more_info)","").replace("(#)",""))," (",e.level," / ",e.x4,")"]}),(0,a.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:t?"Upgrade Group (#".concat(n+1).concat(e.sequence.length>1?" to #".concat(n+e.sequence.length):"",")"):"Upgrade #".concat(n+1)})]})]}),t&&e.combinedStatChanges?renderCombinedStats(e):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Z,{sx:{my:1}}),"all"===K?(0,M.cleanUnderscore)(e.description):renderStatChanges(e.statChanges),(0,a.jsx)(s.Z,{sx:{my:1}}),(0,a.jsxs)(c.Z,{direction:"row",gap:1,alignItems:"center",children:[(0,a.jsx)("img",{style:{objectPosition:"0 -6px"},src:"".concat(M.prefix,"data/").concat(B).concat(r,"_x1.png"),alt:""}),(0,a.jsxs)(l.Z,{variant:"body2",children:["Cost: ",(0,M.notateNumber)(e.cost)]})]})]})]})},n)})}):(0,a.jsx)(b.Z,{component:y.Z,sx:{maxWidth:"100%",overflowX:"auto"},children:(0,a.jsxs)(w.Z,{size:"small",children:[(0,a.jsx)(k.Z,{children:(0,a.jsxs)(S.Z,{children:[(0,a.jsx)(I.Z,{children:"#"}),(0,a.jsx)(I.Z,{children:"Icon"}),(0,a.jsx)(I.Z,{children:"Name"}),(0,a.jsx)(I.Z,{children:"Level"}),(0,a.jsx)(I.Z,{children:"Stat Changes"}),(0,a.jsx)(I.Z,{children:"Cost"})]})}),(0,a.jsx)(L.Z,{children:eu.map((e,t)=>{let n=e.sequence&&e.sequence.length>1,r=V(e),s=G?G(e):e.index;return(0,a.jsxs)(S.Z,{children:[(0,a.jsx)(I.Z,{children:t+1}),(0,a.jsx)(I.Z,{children:(0,a.jsx)("img",{style:{width:24,height:24},src:"".concat(M.prefix,"data/").concat(F).concat(s,".png"),alt:""})}),(0,a.jsx)(I.Z,{children:(0,M.cleanUnderscore)(e.name.replace(/[船般航舞製]/,"").replace("(Tap_for_more_info)","").replace("(#)",""))}),(0,a.jsxs)(I.Z,{children:[e.level," / ",e.x4]}),(0,a.jsx)(I.Z,{children:n&&e.combinedStatChanges?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.Z,{variant:"caption",children:["Levels ",e.startLevel," → ",e.finalLevel]}),e.combinedStatChanges.map((e,t)=>(0,a.jsxs)("div",{children:[e.stat.charAt(0).toUpperCase()+e.stat.slice(1),": ",formatChange(e.change)," (",formatPercentChange(e.percentChange),")"]},t))]}):"all"===K?(0,M.cleanUnderscore)(e.description):e.statChanges.map((e,t)=>(0,a.jsxs)("div",{children:[e.stat.charAt(0).toUpperCase()+e.stat.slice(1),": ",formatChange(e.change)," (",formatPercentChange(e.percentChange),")"]},t))}),(0,a.jsx)(I.Z,{children:(0,a.jsxs)(c.Z,{direction:"row",gap:1,alignItems:"center",children:[(0,a.jsx)("img",{style:{objectPosition:"0 -6px"},src:"".concat(M.prefix,"data/").concat(B).concat(r,"_x1.png"),alt:"",width:20,height:20}),n&&e.totalCost?(0,M.notateNumber)(e.totalCost):(0,M.notateNumber)(e.cost)]})})]},e.upgradeIndex)})})]})}):(0,a.jsx)(l.Z,{variant:"body1",color:"text.secondary",children:"No viable upgrades found for this category with your current resources."})]})}},30509:function(e,t,n){var a=n(85893),r=n(67294),l=n(31002),s=n(29676),c=n(40044),i=n(30925),o=n(27709),d=n(11163);t.Z=e=>{var t;let{tabs:n,components:h,icons:u,children:x,onTabChange:p,forceScroll:g,orientation:m="horizontal",iconsOnly:j,queryKey:v="t",clearOnChange:Z=[],disableQuery:f=!1}=e,C=(0,l.Z)(e=>e.breakpoints.down("md"),{noSsr:!0}),b=(0,d.useRouter)(),[y,w]=(0,r.useState)(0),k=b.query[v],S=n.findIndex(e=>e===k),I=f?y:S>=0?S:0;(0,r.useEffect)(()=>{f||k||b.replace({pathname:b.pathname,query:{...b.query,[v]:n[I]}},void 0,{shallow:!0})},[k,v,n,I,b,f]);let L=Array.isArray(x)?x:[x];return(0,a.jsxs)(o.Z,{sx:"vertical"===m?{flexGrow:1,display:"flex"}:{},children:[(0,a.jsx)(s.Z,{centered:!g&&(!C||C&&n.length<4),scrollButtons:!0,allowScrollButtonsMobile:!0,sx:{marginBottom:3},variant:C&&n.length>=4||g?"scrollable":"standard",value:I,onChange:(e,t)=>{if(f)w(t);else{let e={...b.query,[v]:n[t]};Z.forEach(t=>delete e[t]),b.push({pathname:b.pathname,query:e},void 0,{shallow:!0})}p&&p(t)},children:null===(t=null!=h?h:n)||void 0===t?void 0:t.map((e,t)=>(0,a.jsx)(c.Z,{iconPosition:"start",icon:(null==u?void 0:u[t])?(0,a.jsx)("img",{src:"".concat(i.prefix).concat(null==u?void 0:u[t],".png")}):null,wrapped:!0,label:j?"":e,sx:{minWidth:62}},"".concat(null==e?void 0:e[t],"-").concat(t)))}),p?x:null==L?void 0:L.map((e,t)=>t===I?e:null)]})}},62801:function(e,t,n){var a=n(85893),r=n(50480),l=n(69368),s=n(67294),c=n(7336);t.Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],[n,i]=(0,s.useState)(!0),[o,d]=(0,c.I)({key:"checkbox-".concat(e),defaultValue:t});return(0,s.useEffect)(()=>{i(!1)},[]),[()=>n?null:(0,a.jsx)(r.Z,{sx:{width:"fit-content"},control:(0,a.jsx)(l.Z,{checked:o,onChange:()=>d(e=>!e)}),label:e}),o,d]}},76947:function(e,t,n){n.d(t,{Z:function(){return a}});/**
 * @license @tabler/icons-react v3.30.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var a=(0,n(33733).Z)("filled","info-circle-filled","IconInfoCircleFilled",[["path",{d:"M12 2c5.523 0 10 4.477 10 10a10 10 0 0 1 -19.995 .324l-.005 -.324l.004 -.28c.148 -5.393 4.566 -9.72 9.996 -9.72zm0 9h-1l-.117 .007a1 1 0 0 0 0 1.986l.117 .007v3l.007 .117a1 1 0 0 0 .876 .876l.117 .007h1l.117 -.007a1 1 0 0 0 .876 -.876l.007 -.117l-.007 -.117a1 1 0 0 0 -.764 -.857l-.112 -.02l-.117 -.006v-3l-.007 -.117a1 1 0 0 0 -.876 -.876l-.117 -.007zm.01 -3l-.127 .007a1 1 0 0 0 0 1.986l.117 .007l.127 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z",key:"svg-0"}]])},29540:function(e,t,n){n.d(t,{Z:function(){return a}});/**
 * @license @tabler/icons-react v3.30.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var a=(0,n(33733).Z)("outline","list","IconList",[["path",{d:"M9 6l11 0",key:"svg-0"}],["path",{d:"M9 12l11 0",key:"svg-1"}],["path",{d:"M9 18l11 0",key:"svg-2"}],["path",{d:"M5 6l0 .01",key:"svg-3"}],["path",{d:"M5 12l0 .01",key:"svg-4"}],["path",{d:"M5 18l0 .01",key:"svg-5"}]])},95605:function(e,t,n){n.d(t,{Z:function(){return a}});/**
 * @license @tabler/icons-react v3.30.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var a=(0,n(33733).Z)("outline","table","IconTable",[["path",{d:"M3 5a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M3 10h18",key:"svg-1"}],["path",{d:"M10 3v18",key:"svg-2"}]])}}]);