(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,571853,e=>{"use strict";let t=async()=>{let e=await fetch("https://oauth2.googleapis.com/device/code",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"client_id=267901585099-u6fjd75v6k9gefq7bcokcndv99riir5j&scope=email profile"});return await e.json()},a=async e=>{try{let t=`client_id=267901585099-u6fjd75v6k9gefq7bcokcndv99riir5j&client_secret=HzoZF-UKUNfFwBuz4vafwsaR&device_code=${e}&grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Adevice_code`,a=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});return await a.json()}catch(e){console.error("Error has occurred while trying to authenticate:",e)}};e.s(["getUserAndDeviceCode",()=>t,"getUserToken",()=>a])},565482,374960,527320,996534,e=>{"use strict";var t=e.i(388866);e.s(["List",()=>t.default],565482),e.i(350461);var a=e.i(191788),s=e.i(56206),n=e.i(600961),o=e.i(174855),r=e.i(280445),i=e.i(590117),l=e.i(395724),u=e.i(916989),c=e.i(75136),d=e.i(860452),g=e.i(713149),p=e.i(46739);function m(e){return(0,p.default)("MuiListItem",e)}function f(e){return(0,p.default)("MuiListItemButton",e)}(0,g.default)("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);let B=(0,g.default)("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function h(e){return(0,p.default)("MuiListItemSecondaryAction",e)}e.s(["default",0,B,"getListItemButtonUtilityClass",()=>f],374960),e.s(["listItemButtonClasses",0,B],527320),(0,g.default)("MuiListItemSecondaryAction",["root","disableGutters"]);var y=e.i(391398);let v=(0,r.styled)("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.disableGutters&&t.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:e})=>e.disableGutters,style:{right:0}}]}),S=a.forwardRef(function(e,t){let o=(0,l.useDefaultProps)({props:e,name:"MuiListItemSecondaryAction"}),{className:r,...i}=o,u=a.useContext(d.default),c={...o,disableGutters:u.disableGutters},g=(e=>{let{disableGutters:t,classes:a}=e;return(0,n.default)({root:["root",t&&"disableGutters"]},h,a)})(c);return(0,y.jsx)(v,{className:(0,s.default)(g.root,r),ownerState:c,ref:t,...i})});S.muiName="ListItemSecondaryAction";let T=(0,r.styled)("div",{name:"MuiListItem",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.dense&&t.dense,"flex-start"===a.alignItems&&t.alignItemsFlexStart,a.divider&&t.divider,!a.disableGutters&&t.gutters,!a.disablePadding&&t.padding,a.hasSecondaryAction&&t.secondaryAction]}})((0,i.default)(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>!e.disablePadding&&e.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:e})=>!e.disablePadding&&!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>!e.disablePadding&&!!e.secondaryAction,style:{paddingRight:48}},{props:({ownerState:e})=>!!e.secondaryAction,style:{[`& > .${B.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>e.button,style:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:e})=>e.hasSecondaryAction,style:{paddingRight:48}}]}))),_=(0,r.styled)("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),b=a.forwardRef(function(e,t){let r=(0,l.useDefaultProps)({props:e,name:"MuiListItem"}),{alignItems:i="center",children:g,className:p,component:f,components:B={},componentsProps:h={},ContainerComponent:v="li",ContainerProps:{className:b,...M}={},dense:A=!1,disableGutters:I=!1,disablePadding:O=!1,divider:C=!1,secondaryAction:E,slotProps:w={},slots:P={},...x}=r,L=a.useContext(d.default),R=a.useMemo(()=>({dense:A||L.dense||!1,alignItems:i,disableGutters:I}),[i,L.dense,A,I]),D=a.useRef(null),k=a.Children.toArray(g),N=k.length&&(0,u.default)(k[k.length-1],["ListItemSecondaryAction"]),G={...r,alignItems:i,dense:R.dense,disableGutters:I,disablePadding:O,divider:C,hasSecondaryAction:N},F=(e=>{let{alignItems:t,classes:a,dense:s,disableGutters:o,disablePadding:r,divider:i,hasSecondaryAction:l}=e;return(0,n.default)({root:["root",s&&"dense",!o&&"gutters",!r&&"padding",i&&"divider","flex-start"===t&&"alignItemsFlexStart",l&&"secondaryAction"],container:["container"]},m,a)})(G),U=(0,c.default)(D,t),H=P.root||B.Root||T,$=w.root||h.root||{},j={className:(0,s.default)(F.root,$.className,p),...x},V=f||"li";return N?(V=j.component||f?V:"div","li"===v&&("li"===V?V="div":"li"===j.component&&(j.component="div")),(0,y.jsx)(d.default.Provider,{value:R,children:(0,y.jsxs)(_,{as:v,className:(0,s.default)(F.container,b),ref:U,ownerState:G,...M,children:[(0,y.jsx)(H,{...$,...!(0,o.default)(H)&&{as:V,ownerState:{...G,...$.ownerState}},...j,children:k}),k.pop()]})})):(0,y.jsx)(d.default.Provider,{value:R,children:(0,y.jsxs)(H,{...$,as:V,ref:U,...!(0,o.default)(H)&&{ownerState:{...G,...$.ownerState}},...j,children:[k,E&&(0,y.jsx)(S,{children:E})]})})});e.s(["ListItem",0,b],996534)},824048,e=>{"use strict";e.i(350461);var t=e.i(191788),a=e.i(56206),s=e.i(600961),n=e.i(280445),o=e.i(590117),r=e.i(395724),i=e.i(312326),l=e.i(860452),u=e.i(391398);let c=(0,n.styled)("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,"flex-start"===a.alignItems&&t.alignItemsFlexStart]}})((0,o.default)(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),d=t.forwardRef(function(e,n){let o=(0,r.useDefaultProps)({props:e,name:"MuiListItemIcon"}),{className:d,...g}=o,p=t.useContext(l.default),m={...o,alignItems:p.alignItems},f=(e=>{let{alignItems:t,classes:a}=e;return(0,s.default)({root:["root","flex-start"===t&&"alignItemsFlexStart"]},i.getListItemIconUtilityClass,a)})(m);return(0,u.jsx)(c,{className:(0,a.default)(f.root,d),ownerState:m,ref:n,...g})});e.s(["ListItemIcon",0,d],824048)},164295,937157,e=>{"use strict";e.i(350461);var t=e.i(191788),a=e.i(56206),s=e.i(600961),n=e.i(115871),o=e.i(343906);e.s(["typographyClasses",()=>o.default],937157);var o=o,r=e.i(860452),i=e.i(280445),l=e.i(395724),u=e.i(474844),c=e.i(69998),d=e.i(391398);let g=(0,i.styled)("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[{[`& .${u.default.primary}`]:t.primary},{[`& .${u.default.secondary}`]:t.secondary},t.root,a.inset&&t.inset,a.primary&&a.secondary&&t.multiline,a.dense&&t.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${o.default.root}:where(& .${u.default.primary})`]:{display:"block"},[`.${o.default.root}:where(& .${u.default.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),p=t.forwardRef(function(e,o){let i=(0,l.useDefaultProps)({props:e,name:"MuiListItemText"}),{children:p,className:m,disableTypography:f=!1,inset:B=!1,primary:h,primaryTypographyProps:y,secondary:v,secondaryTypographyProps:S,slots:T={},slotProps:_={},...b}=i,{dense:M}=t.useContext(r.default),A=null!=h?h:p,I=v,O={...i,disableTypography:f,inset:B,primary:!!A,secondary:!!I,dense:M},C=(e=>{let{classes:t,inset:a,primary:n,secondary:o,dense:r}=e;return(0,s.default)({root:["root",a&&"inset",r&&"dense",n&&o&&"multiline"],primary:["primary"],secondary:["secondary"]},u.getListItemTextUtilityClass,t)})(O),E={slots:T,slotProps:{primary:y,secondary:S,..._}},[w,P]=(0,c.default)("primary",{className:C.primary,elementType:n.default,externalForwardedProps:E,ownerState:O}),[x,L]=(0,c.default)("secondary",{className:C.secondary,elementType:n.default,externalForwardedProps:E,ownerState:O});return null==A||A.type===n.default||f||(A=(0,d.jsx)(w,{variant:M?"body2":"body1",component:P?.variant?void 0:"span",...P,children:A})),null==I||I.type===n.default||f||(I=(0,d.jsx)(x,{variant:"body2",color:"textSecondary",...L,children:I})),(0,d.jsxs)(g,{className:(0,a.default)(C.root,m),ownerState:O,ref:o,...b,children:[A,I]})});e.s(["ListItemText",0,p],164295)},34121,e=>{"use strict";var t=e.i(191788),a=e.i(56206),s=e.i(600961),n=e.i(203060),o=e.i(280445),r=e.i(590117),i=e.i(395724),l=e.i(889095),u=e.i(941661),c=e.i(952753),d=e.i(75136),g=e.i(860452),p=e.i(374960),m=e.i(391398);let f=(0,o.styled)(u.default,{shouldForwardProp:e=>(0,l.default)(e)||"classes"===e,name:"MuiListItemButton",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:a}=e;return[t.root,a.dense&&t.dense,"flex-start"===a.alignItems&&t.alignItemsFlexStart,a.divider&&t.divider,!a.disableGutters&&t.gutters]}})((0,r.default)(({theme:e})=>({display:"flex",flexGrow:1,justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minWidth:0,boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${p.default.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,n.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${p.default.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:(0,n.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${p.default.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:(0,n.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:(0,n.alpha)(e.palette.primary.main,e.palette.action.selectedOpacity)}},[`&.${p.default.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${p.default.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),B=t.forwardRef(function(e,n){let o=(0,i.useDefaultProps)({props:e,name:"MuiListItemButton"}),{alignItems:r="center",autoFocus:l=!1,component:u="div",children:B,dense:h=!1,disableGutters:y=!1,divider:v=!1,focusVisibleClassName:S,selected:T=!1,className:_,...b}=o,M=t.useContext(g.default),A=t.useMemo(()=>({dense:h||M.dense||!1,alignItems:r,disableGutters:y}),[r,M.dense,h,y]),I=t.useRef(null);(0,c.default)(()=>{l&&I.current&&I.current.focus()},[l]);let O={...o,alignItems:r,dense:A.dense,disableGutters:y,divider:v,selected:T},C=(e=>{let{alignItems:t,classes:a,dense:n,disabled:o,disableGutters:r,divider:i,selected:l}=e,u=(0,s.default)({root:["root",n&&"dense",!r&&"gutters",i&&"divider",o&&"disabled","flex-start"===t&&"alignItemsFlexStart",l&&"selected"]},p.getListItemButtonUtilityClass,a);return{...a,...u}})(O),E=(0,d.default)(I,n);return(0,m.jsx)(g.default.Provider,{value:A,children:(0,m.jsx)(f,{ref:E,href:b.href||b.to,component:(b.href||b.to)&&"div"===u?"button":u,focusVisibleClassName:(0,a.default)(C.focusVisible,S),ownerState:O,className:(0,a.default)(C.root,_),...b,classes:C,children:B})})});e.s(["default",0,B])},575982,750935,e=>{"use strict";e.s(["default",()=>h,"offlineTools",()=>B],575982);var t=e.i(391398),a=e.i(261576),s=e.i(717803),n=e.i(565482),o=e.i(996534),r=e.i(824048),i=e.i(164295),l=e.i(886779),u=e.i(191788),c=e.i(203828),d=e.i(985978),g=e.i(285592),p=e.i(34121),m=e.i(162271),f=e.i(608580);let B={cardSearch:!0,builds:!0,itemBrowser:!0,itemPlanner:!0},h=e=>{let h,v,S,T,_,b,M,A,I,O,C=(0,a.c)(21),{fromList:E}=e,{state:w}=(0,u.useContext)(d.AppContext),P=(0,c.useRouter)();C[0]!==P?(h=e=>{let t=`/tools/${e}`;void 0!==window.gtag&&window.gtag("event","handle_nav",{event_category:t,event_label:"engagement",value:1}),P.push({pathname:t})},C[0]=P,C[1]=h):h=C[1];let x=h;C[2]!==P?(v=e=>P.pathname.includes(e),C[2]=P,C[3]=v):v=C[3];let L=v;return C[4]===Symbol.for("react.memo_cache_sentinel")?(S={height:"100%"},C[4]=S):S=C[4],C[5]!==E?(T={...E?{padding:0}:{}},C[5]=E,C[6]=T):T=C[6],C[7]===Symbol.for("react.memo_cache_sentinel")?(_=Object.entries(m.PAGES.TOOLS),C[7]=_):_=C[7],C[8]!==x||C[9]!==L||C[10]!==w?.signedIn?(b=_.map((e,a)=>{let[s,n]=e;if(!w?.signedIn&&!B[s])return null;let{icon:o}=n,l=s.split(/(?=[A-Z])/).map(y).join("-"),u=s.split(/(?=[A-Z])/).join(" ").capitalize(),c=L(l);return(0,t.jsxs)(p.default,{selected:c,onClick:()=>x(l),children:[(0,t.jsx)(r.ListItemIcon,{sx:{minWidth:32},children:(0,t.jsx)("img",{style:{objectFit:"contain"},width:32,height:32,src:`${f.prefix}${o}.png`,alt:""})}),(0,t.jsx)(i.ListItemText,{slotProps:{primary:{color:c?"#99ccff":"inherit"}},style:{marginLeft:10},primary:u})]},s+" "+a)}),C[8]=x,C[9]=L,C[10]=w?.signedIn,C[11]=b):b=C[11],C[12]!==T||C[13]!==b?(M=(0,t.jsx)(n.List,{sx:T,children:b}),C[12]=T,C[13]=b,C[14]=M):M=C[14],C[15]!==E?(A=E?null:(0,t.jsx)(n.List,{style:{marginTop:"auto",paddingBottom:0},children:(0,t.jsx)(o.ListItem,{children:(0,t.jsx)(i.ListItemText,{children:(0,t.jsx)(g.default,{display:"inline-block"})})})}),C[15]=E,C[16]=A):A=C[16],C[17]===Symbol.for("react.memo_cache_sentinel")?(I=(0,t.jsx)(s.Divider,{}),C[17]=I):I=C[17],C[18]!==M||C[19]!==A?(O=(0,t.jsxs)(l.Stack,{sx:S,children:[M,A,I]}),C[18]=M,C[19]=A,C[20]=O):O=C[20],O};function y(e){return e.toLowerCase()}let v=async({device_code:e,h_nonce:t,statusToken:a})=>{let s=new URLSearchParams({client_id:"com.lavaflame.idleon.service.signin",nonce:t,redirect_uri:"https://us-central1-idlemmo.cloudfunctions.net/xapsi",response_mode:"form_post",response_type:"code id_token",scope:"email",code:e,state:a});window.open(`https://appleid.apple.com/auth/authorize?${s.toString()}`,"_blank","popup")},S=async()=>{let e=encodeURIComponent("https://us-central1-idlemmo.cloudfunctions.net/tspa"),t=await fetch(`https://appleauth.idleontoolbox.workers.dev/?url=${e}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}});return await t.json()},T=async({device_code:e,statusToken:t})=>{let a=new URLSearchParams;a.append("device_code",e),a.append("statusToken",t);let s=encodeURIComponent("https://us-central1-idlemmo.cloudfunctions.net/capsc"),n=await fetch(`https://appleauth.idleontoolbox.workers.dev/?url=${s}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a});return await n.json()};e.s(["appleAuthorize",()=>v,"geAppleStatus",()=>T,"getAppleCode",()=>S],750935)},478627,e=>{"use strict";var t=e.i(173024),a=e.i(805861),s=e.i(10051),n=e.i(618332),o=e.i(372110),r=e.i(172833),i=e.i(971176),l=e.i(712738),u=e.i(942144),c=e.i(698881),d=e.i(210270),g=e.i(109304),p=e.i(279522),m=e.i(931),f=e.i(276924),B=e.i(685849),h=e.i(608580),y=e.i(433568),v=e.i(733884),S=e.i(262887),T=e.i(775003),_=e.i(962202),b=e.i(24174),M=e.i(398241),A=e.i(198659),I=e.i(39188),O=e.i(405127),C=e.i(435327),E=e.i(161866),w=e.i(267350),P=e.i(470242),x=e.i(304782),L=e.i(476219),R=e.i(620636),D=e.i(809191),k=e.i(441132),N=e.i(420497),G=e.i(264046),F=e.i(694186),U=e.i(384308),H=e.i(695906);let $=(e,m,f)=>{let B=t.mainStatMap?.[e?.class],y=(0,a.getPostOfficeBonus)(e?.postOffice,"Deaths_Storage_Unit",0),v=(0,s.getDungeonFlurboStatBonus)(f?.dungeons?.upgrades,"Weapon_Power"),T=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Weapon_Power"),_=(0,n.getCardBonusByEffect)(f?.cards,"Weapon_Power_(Passive)"),b=(0,o.getGuildBonusBonus)(f?.guild?.guildBonuses,3),M=(0,r.getSigilBonus)(f?.alchemy?.p2w?.sigils,"DUSTER_STUDS"),{value:A}=(0,i.getStatsFromGear)(e,"Weapon_Power",f),I=(0,l.getObolsBonus)(e?.obols,"Weapon_Power"),O=(0,S.getPlayerLabChipBonus)(e,f,19),C="strength"===B?(0,r.getBubbleBonus)(f,"SPEAR_POWAH",!1,"strength"===B):0,E="agility"===B?(0,r.getBubbleBonus)(f,"BOW_POWER",!1,"agility"===B):0,w="wisdom"===B||"luck"===B?(0,r.getBubbleBonus)(f,"WAND_PAWUR",!1,"wisdom"===B):0,P=(0,r.getVialsBonusByStat)(f?.alchemy?.vials,"WeaponPOW"),x=(0,d.getHighestLevelOf)(m,t.CLASSES.Barbarian),L=(0,u.getFamilyBonusBonus)(c.classFamilyBonuses,"WEAPON_POWER",x),R=(0,g.getStarSignBonus)(e,f,"Weapon_Power"),D=(0,p.getArcadeBonus)(f?.arcade?.shop,"Weapon_Power")?.bonus,k=(0,t.getTalentBonus)(e?.flatTalents,"TOUGH_STEAKS"),N=(0,t.getTalentBonus)(e?.flatTalents,"GAMER_STRENGTH"),G=Math.round(10*(0,t.getTalentBonus)(e?.flatTalents,"CREW_ROWING_STRENGTH"))/10,F=(0,t.getTalentBonus)(e?.flatTalents,"BELIEVER_STRENGTH"),U=(0,t.getTalentBonus)(e?.flatTalents,"ANIMALISTIC_FEROCITY"),H=(0,t.getTalentBonus)(e?.flatTalents,"WIRED_IN_POWER"),$=f?.breeding?.storedPets?.[0]?.power??0,j=(0,d.getHighestLevelOf)(m,t.CLASSES.Beginner),V=Math.min((0,t.getTalentBonus)(e?.flatStarTalents,"BEGINNER_BEST_CLASS"),Math.floor(j/10));return 5+y+v+(0,d.getFoodBonus)(e,f,"WeaponPowerBoosts")+(T+_+(b+M))+((A+I)*(1+(O+(C+(E+w)))/100)+V+(P+(L+(R+(D+(k*Math.floor(e?.skillsInfo?.cooking?.level/10)+(N*Math.floor(e?.skillsInfo?.gaming?.level/10)+(G*Math.floor(e?.skillsInfo?.sailing?.level/10)+F*Math.floor(e?.skillsInfo?.divinity?.level/10)))+(U*(0,h.lavaLog)($)+H*Math.floor(e?.skillsInfo?.laboratory?.level/10))))))))},j=(e,s,n,o)=>{let u=V(e,n,"D"),d=V(e,n,"K"),g=t.mainStatMap?.[e?.class],p=e?.equipment?.[1]?.Speed||0,{value:m}=(0,i.getStatsFromGear)(e,56,n),f=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[56]),B=(0,T.getMealsBonusByEffectOrStat)(n,null,"AtkSpd"),h=(0,S.getPlayerLabChipBonus)(e,n,4),y=(0,r.getBubbleBonus)(n,"HYPERSWIFT",!1,"wisdom"===g),v=(0,a.getPostOfficeBonus)(e?.postOffice,"Deaths_Storage_Unit",1),_=c.monsters?.[e?.targetMonster],b=W(_?.MonsterHPTotal,e,n),M=c.mapDetails?.[e?.mapIndex]?.[1]?.[0],A=c.mapDetails?.[e?.mapIndex]?.[1]?.[1],I=Math.min(Math.max(d,1),2.2),O=Math.max(.1,(1+(10-p)/5)/(1+(m+f+(B+(h+(y+v))))/100)),C=o?.maxDamage*(o.mastery+(1-o.mastery)/2)*(1+(o.critDamage-1)*(o.critChance/100))*(o.hitChance/100)*Math.max(u,1);return Math.floor(3600*(0<o.hitChance?Math.min(M/(o.respawnRate+.1),I/(A/(130*(o?.movementSpeed/100))+O*Math.max((b/C+.52)*(1/(o.hitChance/100)),1))):Math.min(M/(o.respawnRate+.1),I/(A/(130*o?.movementSpeed)+O*Math.max(b/C+.52,1)))))},V=(e,a,s)=>{let n=t.mainStatMap?.[e?.class],o=e?.talentsLoadout?.reduce((e,t)=>t?.AFKactivity!==0||t?.[s]===1?e:e*(t?.[s]||1)*(1+Math.min(1,t?.baseLevel/(t?.baseLevel+100))),1),i=(0,t.getTalentBonus)(e?.flatStarTalents,"ATTACKS_ON_SIMMER"),l=(0,t.getTalentBonus)(e?.flatTalents,"TWO_PUNCH_MAN"),u=(0,t.getTalentBonus)(e?.flatTalents,"TRIPLE_JAB"),c=(0,t.getTalentBonus)(e?.flatTalents,"DOUBLE_STRIKE"),d=(0,t.getTalentBonus)(e?.flatTalents,"HAVE_ANOTHER!"),g=(0,t.getTalentBonus)(e?.flatTalents,"HAVE_ANOTHER..._AGAIN!"),p=(0,r.getBubbleBonus)(a,"ALL_FOR_KILL",!1,"wisdom"===n);return"D"===s?o*(1+(Math.min(i,25)+Math.min(p,25))/100)*(1+(l+(u+(c+(d+g))))/100):o},W=(e,t,a)=>e*(1+((0,v.getPrayerBonusAndCurse)(t?.activePrayers,"Big_Brain_Time",a)?.curse+((0,v.getPrayerBonusAndCurse)(t?.activePrayers,"Midas_Minded",a)?.curse+(0,v.getPrayerBonusAndCurse)(t?.activePrayers,"Jawbreaker",a)?.curse))/100),q=(e,s,n,o)=>{let r=K(c.monsters?.[e?.targetMonster],e,n,o),i=(0,t.getTalentBonus)(e?.flatTalents,"MANA_IS_LIFE");i&&(r/=1+i/100);let l=(0,d.getHealthFoodBonus)(e,n,"Health"),u=(0,t.getTalentBonus)(e?.flatStarTalents,"GOBLET_OF_HEMOGLOBIN"),g=l+o?.survivabilityMath*(u/100)*o?.maxHp,p=r*c.mapDetails?.[e?.mapIndex]?.[1]?.[2]-g;if(!(p>0))return 100;{p=o?.maxHp/p;let s=(0,t.getTalentBonus)(e?.flatStarTalents,"BORED_TO_DEATH"),n=(0,a.getPostOfficeBonus)(e?.postOffice,"Locally_Sourced_Organs",2);return Math.min(Math.round(100*(p/(p+(0===s?600/(1+Math.min(50,Math.max(0,n)/100)):Math.max(s/(1+Math.min(50,Math.max(0,n))/100),100))/3600))),100)}},K=(e,a,s,n)=>{let{Damages:o}=e||{},r=o?.[0]-2.5*Math.pow(n?.defence?.value,.8),i=Math.pow(n?.defence?.value,1.5)/100,l=r/Math.max(1+n?.defence?.value/Math.max(o?.[0],1)*i,1),u=(0,t.getTalentBonusIfActive)(a?.activeBuffs,"NO_PAIN_NO_GAIN"),c=(0,t.getTalentBonus)(a?.flatTalents,"BRICKY_SKIN");return u&&(l*=2),c&&(l*=Math.max(.05,1-c/100)),l<.5?0:Math.max(Math.ceil(l),0)},Y=(e,s,o,u)=>{let d=(0,g.getStarSignBonus)(e,o,"Total_Multikill"),m=(0,C.getSaltLickBonus)(o?.saltLick,8),f=(0,B.getStampsBonusByEffect)(o,"Base_Overkill"),{value:h}=(0,i.getStatsFromGear)(e,29,o),y=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[29]),T=c.monsters?.[e?.targetMonster],_=W(T?.MonsterHPTotal,e,o),M=1;for(let e=0;e<50;e++)u?.maxDamage>=2*_*Math.pow(2,e+1)&&(M=e+2);let I=o?.deathNote?.[Math.floor(e?.mapIndex/50)]?.rank||0,O=(0,r.getVialsBonusByStat)(o?.alchemy?.vials,"Overkill"),w=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"VOID_RADIUS"),P=(0,t.getHighestTalentByClass)(s,t.CLASSES.Voidwalker,"MASTER_OF_THE_SYSTEM"),x=(0,p.getArcadeBonus)(o?.arcade?.shop,"Multikill_per_Tier")?.bonus??0,L=(0,b.isArtifactAcquired)(o?.sailing?.artifacts,"Trilobite_Rock")?.bonus??0,R=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"MANA_IS_LIFE","y"),D=(0,S.getPlayerLabChipBonus)(e,o,14),{value:k}=(0,i.getStatsFromGear)(e,71,o),N=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[71]),G=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Multikill_per_tier"),F=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Balance_of_Pain",o)?.bonus,U=(0,A.getShinyBonus)(o?.breeding?.pets,"Multikill_Per_Tier"),H=(0,a.getPostOfficeBonus)(e?.postOffice,"Utilitarian_Capsule",1),$=(0,r.getActiveBubbleBonus)(e?.equippedBubbles,"MR_MASSACRE",o),j=(0,E.getAchievementStatus)(o?.achievements,148),V=(0,E.getAchievementStatus)(o?.achievements,122),q=(0,E.getAchievementStatus)(o?.achievements,123);return Math.floor(d+m+(f+2*o?.towers?.towersTwo)+(h+y+(Math.min(5,j)+(6*V+2*q)))+M*(I+(O+(w+P*Math.floor(o?.accountOptions?.[158]/5))+(x+(L+R)+(D+(k+N+G+(F+U)))+(H+$)))))};e.s(["getMaxDamage",0,(e,o,V)=>{var K,J,z,Q,Z,X,ee,et,ea,es,en,eo,er,ei,el,eu,ec;let ed,eg,ep,em,ef,eB,eh,ey,ev,eS,eT,e_,eb,eM,eA,eI,eO,eC,eE,ew,eP,ex,eL,eR,eD,ek,eN,eG,eF,eU,eH,e$,ej,eV,eW,eq,eK,eY,eJ,ez,eQ,eZ,eX,e0,e1,e2,e5,e3,e9,e4,e8,e6,e7,te,tt,ta,ts={survivabilityMath:0},tn=t.mainStatMap?.[e?.class],to=(0,t.getTalentBonus)(e?.flatTalents,"STRENGTH_IN_NUMBERS"),tr=(0,t.getTalentBonus)(e?.flatTalents,"KNOWLEDGE_IS_POWER"),ti=(0,t.getTalentBonus)(e?.flatTalents,"LUCKY_HIT"),tl=0;"strength"===tn?tl=(0,r.getBubbleBonus)(V,"FARQUAD_FORCE",!1,"strength"===tn):"agility"===tn?tl=(0,r.getBubbleBonus)(V,"QUICKDRAW_QUIVER",!1,"agility"===tn):"wisdom"===tn&&(tl=(0,r.getBubbleBonus)(V,"SMARTER_SPELLS",!1,"wisdom"===tn));let tu=(e?.stats?.[tn]||0)*(1+(to+(tr+ti)+tl)/100),{respawnRate:tc}=(0,m.getRespawnRate)(e,V);ts.respawnRate=tc;let{afkGains:td}=(0,m.getAfkGain)(e,o,V);ts.afkGains=td,ts.maxHp=((e,s,o)=>{let r=(0,d.getFoodBonus)(e,o,"HpBaseBoosts"),p=(0,f.getStatueBonus)(o,4,e?.flatTalents),m=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Base_HP"),h=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Total_HP"),v=(0,B.getStampsBonusByEffect)(o,"Base_HP"),S=(0,a.getPostOfficeBonus)(e?.postOffice,"Locally_Sourced_Organs",0),T=(0,a.getPostOfficeBonus)(e?.postOffice,"Locally_Sourced_Organs",1),_=(0,t.getTalentBonus)(e?.flatTalents,"HEALTH_BOOSTER"),b=(0,t.getTalentBonus)(e?.flatStarTalents,"UBERCHARGED_HEALTH"),M=(0,t.getTalentBonus)(e?.flatTalents,"STRENGTH_IN_NUMBERS"),A=(0,t.getTalentBonus)(e?.flatTalents,"HEALTH_OVERDRIVE"),I=(0,t.getTalentBonus)(e?.flatTalents,"HEMA_OVERDRIVE"),O=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"NO_PAIN_NO_GAIN"),C=(0,g.getStarSignBonus)(e,o,"Total_HP"),E=(0,d.getHighestLevelOf)(s,t.CLASSES.Squire),w=(0,t.getTalentBonus)(e?.flatTalents,"THE_FAMILY_GUY"),P=(0,u.getFamilyBonusBonus)(c.classFamilyBonuses,"TOTAL_HP",E)*((0,t.checkCharClass)(e?.class,t.CLASSES.Squire)&&e?.level===E&&w>0?1+w/100:1),{value:x}=(0,i.getStatsFromGear)(e,15,o),L=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[15]),R=(0,y.getShrineBonus)(o?.shrines,1,e?.mapIndex,o?.cards,o?.sailing?.artifacts),D=(0,d.getGoldenFoodBonus)("Golden_Jam",e,o,s)||1;return(15+m+0+(v+(r+p))+(S+(_+b)+Math.pow(e?.stats?.strength*(1+M/100),1.05)))*((1+(A+(I+x+L))/100)*(1+R/100)*(1===D?D:1+D/100)*(1+T/100)*(1-O/100)*(1+(P+h)/100)*(1+C/100))})(e,o,V),K=e,J=0,z=V,ed=(0,n.getCardBonusByEffect)(K?.cards?.equippedCards,"Base_MP"),eg=(0,n.getCardBonusByEffect)(K?.cards?.equippedCards,"Total_MP"),ep=(0,B.getStampsBonusByEffect)(z,"Base_MP"),em=(0,t.getTalentBonus)(K?.flatTalents,"MANA_BOOSTER"),ef=(0,a.getPostOfficeBonus)(K?.postOffice,"Magician_Starterpack",0),eB=(0,a.getPostOfficeBonus)(K?.postOffice,"Magician_Starterpack",1),ts.maxMp=(1+((0,t.getTalentBonus)(K?.flatTalents,"MANA_OVERDRIVE")+(0,t.getTalentBonus)(K?.flatTalents,"HEMA_OVERDRIVE"))/100)*(1+(eB+eg)/100)*(10+ed+0+ep+(em+(K?.stats?.wisdom+ef))),ts.movementSpeed=(0,m.getPlayerSpeedBonus)(e,o,V),ts.accuracy=((e,o,l,u)=>{let c=t.mainStatMap?.[e?.class],m=(0,r.getVialsBonusByStat)(l?.alchemy?.vials,"baseACC"),h=(0,a.getPostOfficeBonus)(e?.postOffice,"Box_of_Unwanted_Stats",0),y=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Base_accuracy"),{value:_}=(0,i.getStatsFromGear)(e,28,l),b=(0,d.getGoldenFoodBonus)("Butter_Bar",e,l,o)||0,M=(0,B.getStampsBonusByEffect)(l,"Base_Accuracy"),A=(0,r.getBubbleBonus)(l,"SHAQURACY",!1,"agility"===c),I=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Total_Accuracy"),O=e?.cards?.cardSet?.rawName==="CardSet4"?e?.cards?.cardSet?.bonus:0,C=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"EXTENDO_RANGEO"),E=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"BALANCED_SPIRIT"),P=(0,g.getStarSignBonus)(e,l,"Accuracy"),x=(0,f.getStatueBonus)(l,14,e?.flatTalents),L=(0,p.getArcadeBonus)(l?.arcade?.shop,"Total_Accuracy")?.bonus,R=(0,s.getDungeonFlurboStatBonus)(l?.dungeons?.upgrades,"Accuracy"),N=l?.bribes?.[21]?.done?l?.bribes?.[21]?.value:0,G=(0,d.isCompanionBonusActive)(l,23)?l?.companions?.list?.at(23)?.bonus:0,F=(0,t.getTalentBonus)(e?.flatStarTalents,"TIPTOE_QUICKNESS",!0),H=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Balance_of_Precision",l)?.bonus,$=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Beefy_For_Real",l)?.curse,j=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Balance_of_Pain",l)?.curse,V=(0,S.getPlayerLabChipBonus)(e,l,2),W=(0,T.getMealsBonusByEffectOrStat)(l,null,"TotAcc"),q=(0,D.getKangarooBonus)(l?.kangaroo?.bonuses,"Accuracy")||0,K=(0,k.getVoteBonus)(l,3)||0,Y=(0,U.getArmorSetBonus)(l,"AMAROK_SET")||0,J=(0,d.isCompanionBonusActive)(l,0)?(0,w.getMinorDivinityBonus)(e,l,0):e?.linkedDeity===0?e?.deityMinorBonus:0,z=e?.stats?.[({strength:"wisdom",agility:"strength",wisdom:"agility",luck:"luck"})[c]]*(1+A/100)*(1+(C+(I+(P+(E+(x+(L+(R+(N+G))))))))/100);return u/100>1.99&&(z*=1+F/100),z=(Math.pow(z/4,1.4)+(z+(2+m+(h+(y+_+b)+M))))*(1+(z+2*O)/200)*Math.max(.1,1+(H-$-j)/100)*(1+(V+W+q+K+Y)/100)*(1+J/100)})(e,o,V,ts.movementSpeed),ts.critDamage=((e,a,s)=>{let o=t.mainStatMap?.[e?.class],u=(0,t.getTalentBonus)(e?.flatTalents,"FARSIGHT"),d=(0,t.getTalentBonus)(e?.flatTalents,"CRITIKILL"),g=(0,t.getTalentBonus)(e?.flatTalents,"KNUCKLEBUSTER"),p=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"DIVINE_INTERVENTION"),m=(0,r.getBubbleBonus)(s,"BAPPITY_BOOPITY",!1,"strength"===o),h=(0,B.getStampsBonusByEffect)(s,"Critical_Damage"),y=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Critical_Damage"),S=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Circular_Criticals",s)?.curse,{value:T}=(0,i.getStatsFromGear)(e,22,s),_=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[22]);return 1.2+(d+(0,f.getStatueBonus)(s,5,e?.flatTalents)+(u+(h+(100*(1e3>e?.stats?.strength?(Math.pow(e?.stats?.strength+1,.37)-1)/40:(e?.stats?.strength-1e3)/(e?.stats?.strength+2500)*.5+.255)/1.8+(m+(y-S+(g+(T+_+p))))))))/100})(e,0,V),ts.critChance=((e,s,o,u)=>{let d=t.mainStatMap?.[e?.class],p=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Critical_Chance"),m=(0,n.getCardBonusByEffect)(o?.cards,"Critical_Chance_(Passive)"),B=e?.cards?.cardSet?.rawName==="CardSet6"?e?.cards?.cardSet?.bonus:0,y=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Circular_Criticals",o)?.bonus,S=(0,T.getMealsBonusByEffectOrStat)(o,null,"Crit"),_=(0,f.getStatueBonus)(o,13,e?.flatTalents),b=(0,t.getTalentBonus)(e?.flatStarTalents,"MEGA_CRIT"),M=(0,t.getTalentBonus)(e?.flatStarTalents,"OVERACCURATE_CRIT"),A=(0,g.getStarSignBonus)(e,o,"Crit_Chance"),{value:I}=(0,i.getStatsFromGear)(e,23,o),O=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[23]),C=(0,t.getTalentBonus)(e?.flatTalents,"I_SEE_YOU"),w=(0,t.getTalentBonus)(e?.flatTalents,"FARSIGHT",!0),P=(0,E.getAchievementStatus)(o?.achievements,184),x=(0,a.getPostOfficeBonus)(e?.postOffice,"Civil_War_Memory_Box",2),L=c.monsters?.[e?.targetMonster],R=Math.floor(u?.accuracy),D=(0,h.lavaLog)(R-1.5*L?.Defence),k=(0,r.getBubbleBonus)(o,"CHEAP_SHOT",!1,"agility"===d);return 5+B+(p+Math.min(m,50)+(b+(I+O)+(y+S+_+A)))+(C+(w+5*P+(x+M*D)+((1e3>e?.stats?.agility?(Math.pow(e?.stats?.agility+1,.37)-1)/40:(e?.stats?.agility-1e3)/(e?.stats?.agility+2500)*.5+.255)/2.3*100+k)))})(e,0,V,ts),Q=e,Z=0,X=0,ee=ts,eh=c.monsters?.[Q?.targetMonster],ts.hitChance=.5<=(ey=ee?.accuracy/eh?.Defence)?Math.floor(Math.min(100*(.95*ey-.425),100)):0,ts.mastery=((e,a,s)=>{let o=t.mainStatMap?.[e?.class],l=(0,r.getBubbleBonus)(s,"LIL_BIG_DAMAGE",!1,"agility"===o),u=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Minimum_Damage"),c=(0,t.getTalentBonus)(e?.flatTalents,"MASTERY_UP"),{value:d}=(0,i.getStatsFromGear)(e,21,s);return Math.min(.8,.35+(l+(u+(c+d)))/100)})(e,0,V),ts.miningEff=(0,x.getMiningEff)(e,o,V,ts);let{baseDamage:tg}=((e,s,o,u,g)=>{let m=t.mainStatMap?.[e?.class],y=(0,t.getTalentBonus)(e?.flatTalents,"CARRY_A_BIG_STICK"),v=(0,t.getTalentBonus)(e?.flatTalents,"HIGH_POLYMER_LIMBS"),S=(0,t.getTalentBonus)(e?.flatTalents,"POWER_OVERWHELMING"),T=(0,t.getTalentBonus)(e?.flatTalents,"SHARPENED_AXE"),_=$(e,s,o),b=(0,p.getArcadeBonus)(o?.arcade?.shop,"Base_Damage")?.bonus??0,M=(0,d.getGoldenFoodBonus)("Golden_Nomwich",e,o,s),A=(0,B.getStampsBonusByEffect)(o,"Base_Damage"),I=(0,a.getPostOfficeBonus)(e?.postOffice,"Civil_War_Memory_Box",0),{value:O}=(0,i.getStatsFromGear)(e,16,o),C=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[16]),E=(0,f.getStatueBonus)(o,0,e?.flatTalents),w=(0,r.getBubbleBonus)(o,"BIG_MEATY_CLAWS",!1,"strength"===m),P=(0,r.getBubbleBonus)(o,"QUICK_SLAP",!1,"agility"===m),x=(0,r.getBubbleBonus)(o,"NAME_I_GUESS",!1,"wisdom"===m),D=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Base_Damage"),k=(0,r.getSigilBonus)(o?.alchemy?.p2w?.sigils,"PLUNGING_SWORD"),N=Math.pow((_*(1+(y+v+S+(0,H.getCosmoBonus)({majik:o?.hole?.holesObject?.idleonMajiks,t:2,i:4})))/100+T)/3,2)+(g+M+Math.min(150,2*_+g))+(b+(((0,R.getOwlBonus)(o?.owl?.bonuses,"Base DMG")||0)+(((0,L.getUpgradeVaultBonus)(o?.upgradeVault?.upgrades,0)||0)+((0,L.getUpgradeVaultBonus)(o?.upgradeVault?.upgrades,20)||0)*(o?.upgradeVault?.vaultTotalKills?.[5]||0))))+(A+(O+C)+E+(I+(w*(0,h.lavaLog)(Math.max(u.maxHp-250,1))+P*(Math.max(u.movementSpeed/100-1.1,0)/.25)+(x*(0,h.lavaLog)(Math.max(u.maxMp-150,1))+(D+k)))));return N>4e3&&(N=4e3+Math.max(Math.pow(N-4e3,.91),0)),N>15e3&&(N=15e3+Math.max(Math.pow(N-15e3,.84),0)),{baseDamage:N+=(0,d.getFoodBonus)(e,o,"BaseDmgBoosts")}})(e,o,V,ts,tu),tp=(et=e,ea=0,es=V,en=ts,eo=tu,ev=(0,f.getStatueBonus)(es,22,et?.flatTalents),eS=(0,t.getTalentBonus)(et?.flatTalents,"MEAT_SHANK"),eT=(0,t.getTalentBonus)(et?.flatTalents,"OVERCLOCKED_ENERGY"),e_=(0,L.getUpgradeVaultBonus)(es?.upgradeVault?.upgrades,27)||0,eb=es?.upgradeVault?.vaultTotalKills?.[6]||0,eM=(0,L.getUpgradeVaultBonus)(es?.upgradeVault?.upgrades,15)||0,eA=es?.accountOptions?.[338]||0,eI=(0,L.getUpgradeVaultBonus)(es?.upgradeVault?.upgrades,10)||0,eO=es?.bribes?.[30]?.done?es?.bribes?.[30]?.value:0,eC=es?.bribes?.[20]?.done?es?.bribes?.[20]?.value:0,eE=(0,B.getStampsBonusByEffect)(es,"Total_Damage",et),ew=(0,N.getLandRank)(es?.farming?.ranks,14)||0,eP=(0,R.getOwlBonus)(es?.owl?.bonuses,"Total DMG")||0,ex=(0,D.getKangarooBonus)(es?.kangaroo?.bonuses,"Accuracy")||0,eL=es?.bubba?.bonuses?.totalDamage?.bonus||0,1+(Math.pow(eo,.7)+(e_*eb+eM*eA+(.4*eI+eO)+eC+(eE+ew+ev+0)+((0,h.lavaLog)(en.maxHp)*eS+((0,h.lavaLog)(en.maxMp)*eT+(eP+(ex+eL))))))/100),tm=(er=e,ei=o,el=V,eu=ts,ec=tp,eR=(0,t.getTalentBonus)(er?.flatTalents,"VEINS_OF_THE_INFERNAL"),eD=1+Math.min(100,er?.skillsInfo?.smithing?.level||0)/10*eR/100,ek=(0,G.getWinnerBonus)(el,"<x Total DMG")||0,eN=(0,d.getMinigameScore)(el,"chopping"),eG=(0,t.getTalentBonus)(er?.flatTalents,"CHOPPIN_IT_UP_EZ",!0)*Math.floor(eN/25),eF=(0,r.getBubbleBonus)(el,"DMG_OF_THE_SUN",!1),eU=(0,r.getBubbleBonus)(el,"DMG_OF_THE_MOON",!1),eH=(0,r.getBubbleBonus)(el,"DMG_OF_THE_SOUL",!1),e$=(0,t.getTalentBonus)(er?.flatTalents,"SKILLAGE_DAMAGE")*Math.floor((Math.min(...Object.entries(er?.skillsInfo||{})?.filter(([e,{index:t}])=>t<9)?.map(([e,{level:t}])=>t)||[])??0)/5),ej=(0,t.getTalentBonus)(er?.flatTalents,"APOCALYPSE_ZOW"),eV=er?.zow?.finished?.[0]+1||0,eW=c.monsters?.[er?.targetMonster],eq=(0,t.getTalentBonus)(er?.flatTalents,"PRECISION_POWER"),eK=eu.accuracy>=eW?.Defence*2.25?el?.refinery?.totalLevels*eq:0,eY=el?.alchemy?.vials?.reduce((e,{level:t})=>e+ +(t>3),0),eJ=(0,t.getTalentBonus)(er?.flatTalents,"VIRILE_VIALS"),ez=el?.looty?.lootedItems,eQ=(0,t.getTalentBonus)(er?.flatTalents,"LOOTY_MC_SHOOTY"),eZ=(0,B.calcStampCollected)(el?.stamps),eX=(0,t.getTalentBonus)(er?.flatTalents,"PAPERWORK,_GREAT..."),e0=(0,F.getSchematicBonus)({holesObject:el?.hole?.holesObject,t:57,i:0})||0,e1=(0,t.getTalentBonus)(er?.flatTalents,"SPEEDNA")*Math.floor(Math.min(eu.movementSpeed/100-1,10)/.15),e2=(0,t.getTalentBonus)(er?.flatTalents,"DREAMER_DAMAGE"),e5=el?.equinox?.completedClouds||0,e3=(0,t.getTalentBonus)(er?.flatTalents,"FILTHY_DAMAGE")*(0,h.lavaLog)(el?.accountOptions?.[161]||0),e9=(0,t.getTalentBonus)(er?.flatStarTalents,"DUNGEONIC_DAMAGE")*(0,h.lavaLog)(el?.accountOptions?.[71]),e4=(0,t.getTalentBonus)(er?.flatStarTalents,"QUEST_KAPOW!"),e8=Math.min((0,d.calcTotalQuestCompleted)(ei),e4),e6=(0,d.isCompanionBonusActive)(el,0),e7=el?.accountOptions?.[425]>0&&el?.accountOptions?.[425]===2,te=e6||e7?(0,w.getMinorDivinityBonus)(er,el,2):er?.linkedDeity===2?er?.deityMinorBonus:er?.secondLinkedDeityIndex===2?er?.secondDeityMinorBonus:0,100<(ta=ec*eD*(1+ek/100)*(1+(eG+(eF+(eU+eH)+e$+ej*eV+eK+eJ*eY+(eQ*ez/50+(eX*eZ/10+e0))+e1+(e2*e5+e3+(e9+e8))+te))/100)*(1===(tt=(0,d.getGoldenFoodBonus)("Golden_Kebabs",er,el,ei)||1)?tt:1+tt/100))?100+Math.max(Math.pow(ta-100,.86),0):ta),tf=((e,s,o)=>{let p=t.mainStatMap?.[e?.class],{strength:m,agility:f,wisdom:B,luck:x}=e?.stats||{},L=1+(0,t.getTalentBonus)(e?.flatTalents,"WORMHOLE_EMPEROR")*(0,h.lavaLog)(o?.accountOptions?.[152]??0)/100,R=(0,P.getEquinoxBonus)(o?.equinox?.upgrades,"Matching_Scims"),D=5*(0,_.getEclipseSkullsBonus)(o),k=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"NO_PAIN_NO_GAIN"),N=(0,g.getStarSignBonus)(e,o,"Total_Damage"),G=o?.divinity?.unlockedDeities??0,F=(0,t.getHighestTalentByClass)(s,t.CLASSES.Elemental_Sorcerer,"GODS_CHOSEN_CHILDREN",!1,!0),U=(0,t.getHighestTalentByClass)(s,t.CLASSES.Voidwalker,"POWER_ORB"),H=(0,y.getShrineBonus)(o?.shrines,0,e?.mapIndex,o?.cards,o?.sailing?.artifacts),$=(0,a.getPostOfficeBonus)(e?.postOffice,"Deaths_Storage_Unit",2),j=(0,a.getPostOfficeBonus)(e?.postOffice,"Scurvy_C'arr'ate",2),V=(0,a.getPostOfficeBonus)(e?.postOffice,"Gaming_Lootcrate",2),W=(0,d.getHighestLevelOf)(s,t.CLASSES.Blood_Berserker),q=(0,t.getTalentBonus)(e?.flatTalents,"THE_FAMILY_GUY"),K=(0,u.getFamilyBonusBonus)(c.classFamilyBonuses,"TOTAL_DAMAGE",W)*((0,t.checkCharClass)(e?.class,t.CLASSES.Blood_Berserker)&&q>0?1+q/100:1),Y=(0,b.isArtifactAcquired)(o?.sailing?.artifacts,"Crystal_Steak"),J=Y?.additionalData?.[e?.playerId]?.bonus??0,z=(0,b.isArtifactAcquired)(o?.sailing?.artifacts,"Ruble_Cuble")?.bonus??0,Q=(0,b.isArtifactAcquired)(o?.sailing?.artifacts,"Fun_Hippoete")?.bonus??0,Z=(0,b.isArtifactAcquired)(o?.sailing?.artifacts,"Opera_Mask")?.bonus??0,X=(0,b.isArtifactAcquired)(o?.sailing?.artifacts,"The_True_Lantern")?.bonus??0,ee=(0,M.getAtomBonus)(o,"Carbon_-_Wizard_Maximizer")??0,et=(0,A.getShinyBonus)(o?.breeding?.pets,"Total_Damage"),ea=(0,I.isSuperbitUnlocked)(o,"MSA_Skill_EXP")?.bonus??0,es=(0,d.getSkillMasteryBonusByIndex)(o?.totalSkillsLevels,o?.rift,0),en=(0,r.getBubbleBonus)(o,"BRITTLEY_SPEARS",!1,"strength"===p),eo=(0,r.getBubbleBonus)(o,"BOW_JACK",!1,"agility"===p),er=(0,r.getBubbleBonus)(o,"MATTY_STAFFORD",!1,"wisdom"===p),ei="strength"===p||"luck"===p?(0,r.getBubbleBonus)(o,"POWER_TRIONE",!1,"strength"===p):0,el="agility"===p?(0,r.getBubbleBonus)(o,"POWER_TRITWO",!1,"agility"===p):0,eu="wisdom"===p?(0,r.getBubbleBonus)(o,"POWER_TRITHREE",!1,"wisdom"===p):0,ec=o?.towers?.totalLevels>=O.constructionMasteryThresholds?.[2]?2*Math.floor((o?.towers?.totalLevels-O.constructionMasteryThresholds?.[2])/10):0,ed=(0,t.getTalentBonus)(e?.flatTalents,"GILDED_SWORD"),eg=(0,C.getSaltLickBonus)(o?.saltLick,9),{value:ep}=(0,i.getStatsFromGear)(e,45,o),em=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[45]),ef=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Beefy_For_Real",o)?.bonus,eB=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Balance_of_Precision",o)?.curse,eh=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Fibers_of_Absence",o)?.curse,ey=(0,S.getLabBonus)(o?.lab?.labBonuses,0),ev=(0,S.getLabBonus)(o?.lab?.labBonuses,11),eS=(0,S.getLabBonus)(o?.lab.labBonuses,8),eT=o?.lab.jewels?.slice(7,10)?.every(({active:e})=>e)?2:1,e_=(0,S.getJewelBonus)(o?.lab.jewels,10,eS)*eT,eb=e?.cards?.cardSet?.rawName==="CardSet26"?e?.cards?.cardSet?.bonus:0,eM=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Total_Damage"),eA=o?.accountOptions?.[89],eI=c.randomList?.[53],eO=+(0,d.isArenaBonusActive)(eA,eI,2),eC=+(0,d.isArenaBonusActive)(eA,eI,15),eE=(0,S.getPlayerLabChipBonus)(e,o,12),ew=(0,T.getMealsBonusByEffectOrStat)(o,null,"TotDmg"),eP=(0,t.getTalentBonus)(e?.flatTalents,"CURSE_OF_MR_LOOTY_BOOTY"),ex=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"BALANCED_SPIRIT"),eL=(0,w.getGodBlessingBonus)(o?.divinity?.deities,"Flutterbis"),eR=(0,w.getGodBlessingBonus)(o?.divinity?.deities,"Kattlecruk"),eD=L*(1+R/100)*(1+D/100)*(1+(k+(N+(Math.max(0,G-10)*F+Math.floor(Math.max(0,e?.level-200)/50)*U)))/100)*(1+(H+($+(j+V)+K)+(J+(ee+(et+ea))))/100)*(1+(es+en+(eo+(er+(z+(Q+(ei*Math.floor(Math.max(m,x)/250)+el*Math.floor(f/250)+(eu*Math.floor(B/250)+ec)))))))/100)*(1+(ed+(eg+(ep+em+ef))+(ey+(ev+e_)+(Z+X)))/100)*(1+(eM+eb)/100)*(1+(20*eO+40*eC+(eE+ew)+2*(0,E.getAchievementStatus)(o?.achievements,58)+3*(0,E.getAchievementStatus)(o?.achievements,59)+(5*(0,E.getAchievementStatus)(o?.achievements,60)+5*(0,E.getAchievementStatus)(o?.achievements,62))+2*(0,E.getAchievementStatus)(o?.achievements,119)+3*(0,E.getAchievementStatus)(o?.achievements,120)+(5*(0,E.getAchievementStatus)(o?.achievements,121)+2*(0,E.getAchievementStatus)(o?.achievements,185)+3*(0,E.getAchievementStatus)(o?.achievements,186)+(5*(0,E.getAchievementStatus)(o?.achievements,187)+((0,E.getAchievementStatus)(o?.achievements,240)+(0,E.getAchievementStatus)(o?.achievements,280))+3*(0,E.getAchievementStatus)(o?.achievements,297)+2*(0,E.getAchievementStatus)(o?.achievements,303)+(2*(0,E.getAchievementStatus)(o?.achievements,364)+(4*(0,E.getAchievementStatus)(o?.achievements,354)+3*(0,E.getAchievementStatus)(o?.achievements,375)))+(eL+eR))))/100)*Math.max((1-eP/100)*(1-ex/100)*Math.max(.01,1-(eB+eh)/100),.05);return 100<eD?100+Math.max(Math.pow(eD-100,.86),0):eD})(e,o,V,ts);return ts.maxDamage=tg*tm*tf,ts.minDamage=ts.mastery*ts.maxDamage,ts.defence=((e,o,u)=>{let m=t.mainStatMap?.[e?.class],_=(0,a.getPostOfficeBonus)(e?.postOffice,"Box_of_Unwanted_Stats",1),b=e?.cards?.cardSet?.rawName==="CardSet4"?e?.cards?.cardSet?.bonus:0,M=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Base_Defence"),A=(0,n.getCardBonusByEffect)(e?.cards?.equippedCards,"Defence_from_Equipment"),I=(0,r.getBubbleBonus)(u,"FMJ",!1,"strength"===m),O=(0,B.getStampsBonusByEffect)(u,"Base_Defence"),{value:C}=(0,i.getStatsFromGear)(e,"Defence",u),E=(0,l.getObolsBonus)(e?.obols,"Defence"),{value:P}=(0,i.getStatsFromGear)(e,50,u),x=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[50]),{value:R}=(0,i.getStatsFromGear)(e,7,u),N=(0,l.getObolsBonus)(e?.obols,c.bonuses?.etcBonuses?.[7]),G=(0,p.getArcadeBonus)(u?.arcade?.shop,"Base_Defence")?.bonus??0,F=(0,f.getStatueBonus)(u,7,e?.flatTalents),H=(0,T.getMealsBonusByEffectOrStat)(u,null,"Def"),$=(0,t.getTalentBonus)(e?.flatTalents,"BRICKY_SKIN",!0),j=(0,t.getTalentBonus)(e?.flatTalents,"BUCKLERED_UP"),V=(0,y.getShrineBonus)(u?.shrines,1,e?.mapIndex,u?.cards,u?.sailing?.artifacts),W=u?.bribes?.[22]?.done?u?.bribes?.[22]?.value:0,q=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Beefy_For_Real",u)?.curse,K=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Balance_of_Pain",u)?.curse,Y=(0,d.getGoldenFoodBonus)("Golden_Meat_Pie",e,u,o),J=(0,g.getStarSignBonus)(e,u,"Defence"),z=(0,t.getTalentBonusIfActive)(e?.activeBuffs,"BALANCED_SPIRIT"),Q=(0,s.getDungeonFlurboStatBonus)(u?.dungeons?.upgrades,"Defence"),Z=(0,S.getPlayerLabChipBonus)(e,u,0),X=(0,d.isCompanionBonusActive)(u,0),ee=u?.accountOptions?.[425]===0,et=(0,L.getUpgradeVaultBonus)(u?.upgradeVault?.upgrades,46)||0,ea=(0,d.isCompanionBonusActive)(u,21)?u?.companions?.list?.at(21)?.bonus:0,es=(0,n.getCardBonusByEffect)(u?.cards,"DEF_from_Equips_(Passive)"),en=(0,U.getArmorSetBonus)(u,"AMAROK_SET")||0,eo=(0,D.getKangarooBonus)(u?.kangaroo?.bonuses,"Defence")||0,er=(0,L.getUpgradeVaultBonus)(u?.upgradeVault?.upgrades,5)||0,ei=(0,k.getVoteBonus)(u,3)||0,el=X||ee?(0,w.getMinorDivinityBonus)(e,u,0):e?.linkedDeity===0?e?.deityMinorBonus:0,eu=Math.floor((_+M+Math.min(e?.level,I)+(O+(P+x)+G+F)+((C+E)*(1+(I+et+A+ea+es)/100)+(H+$)))*(1+(V+W)/100)*Math.max(.05,1-(q+K)/100)*(1+(Y+j+(R+N+(J+(z+(b+(Q+Z+en))))))/100)*(1+(el+ei)/100)+eo+er),ec={statName:"Defence",totalValue:(0,h.notateNumber)(eu),categories:[{name:"Additive",sources:[{name:"Post Office",value:_},{name:"Card Bonus",value:M+A+es},{name:"Cardset Bonus",value:b},{name:"Flurbo Bonus",value:Q},{name:"Minor Divinity Bonus",value:el},{name:"Vote Bonus",value:ei},{name:"Chip Bonus",value:Z},{name:"Bubble Bonus",value:I},{name:"Vault",value:et+er},{name:"Companion",value:ea},{name:"Amarok Set Bonus",value:en},{name:"Roo Bonus",value:eo},{name:"Stamp Bonus",value:O},{name:"Equip Base Defence",value:P+x},{name:"Equip Defence",value:C+E},{name:"Equip % Defence",value:R+N},{name:"Arcade Bonus",value:G},{name:"Statue Bonus",value:F},{name:"Meal Bonus",value:H},{name:"Shrine Bonus",value:V},{name:"Bribe Bonus",value:W},{name:"Prayers",value:q+K},{name:"Golden Food",value:Y},{name:"Talents Bonus",value:$+j},{name:"Active Talents Bonus",value:z}]}]};return{value:eu,breakdown:ec}})(e,o,V,ts),ts.survivability=q(e,o,V,ts),ts.killsPerHour=j(e,o,V,ts),ts.survivabilityMath=ts.killsPerHour*ts.afkGains*(ts.survivability/100),ts.survivability=q(e,o,V,ts),ts.killsPerHour=j(e,o,V,ts),ts.killPerkill=((e,a,s,n)=>{let{value:o}=(0,i.getStatsFromGear)(e,68,s),{value:l}=(0,i.getStatsFromGear)(e,69,s),{value:u}=(0,i.getStatsFromGear)(e,70,s),g=c.monsters?.[e?.targetMonster],p=W(g?.MonsterHPTotal,e,s),m=n?.maxDamage>=2*p&&.5<s?.towers?.towersTwo?n?.accuracy>1.5*g?.Defence:0,f=(0,S.getLabBonus)(s?.lab?.labBonuses,4),B=0;100<=e?.mapIndex&&150>e?.mapIndex?B=o:150<=e?.mapIndex&&200>e?.mapIndex?B=l:50<=e?.mapIndex&&100>e?.mapIndex&&(B=u);let h=(0,d.isCompanionBonusActive)(s,0)||e?.linkedDeity===2||e?.secondLinkedDeityIndex===2?1:0,y=(0,t.getTalentBonus)(e?.flatTalents,"CHARRED_SKULLS"),T=(0,t.getTalentBonus)(e?.flatTalents,"STACKED_SKULLS"),_=(0,t.getTalentBonus)(e?.flatTalents,"MEMORIAL_SKULLS"),b=(0,t.getTalentBonus)(e?.flatTalents,"MONSTER_DECIMATOR"),M=Y(e,a,s,n),A=(0,r.getActiveBubbleBonus)(e?.equippedBubbles,"KILL_PER_KILL",s),I=(0,v.getPrayerBonusAndCurse)(e?.activePrayers,"Fibers_of_Absence",s)?.bonus;return m?Math.max(1,f)*(1+B/100)*Math.max(1,1+h)*(1+(y*(e?.stats?.strength/1e3)+(T*(e?.stats?.agility/1e3)+(_*(e?.stats?.wisdom/1e3)+b))+(M+(A+I)))/100):Math.max(1,f)*(1+B/100)*Math.max(1,1+h)*(1+(y*(e?.stats?.strength/1e3)+(T*(e?.stats?.agility/1e3)+(_*(e?.stats?.wisdom/1e3)+b))+(A+I))/100)})(e,o,V,ts),ts.finalKillsPerHour=Math.floor(ts.killsPerHour*ts.afkGains*(ts.survivability/100)*ts.killPerkill),ts},"notateDamage",0,e=>{let{minDamage:t,maxDamage:a}=e;return[a<9999999?`${Math.ceil(t)}~${Math.ceil(a)}`:a<0x3b9ac9ff?`${Math.ceil(t/1e3)/1e3}[~${Math.ceil(a/1e3)/1e3}[`:a<0x174876e7ff?`${Math.ceil(t/1e5)/10}[~${Math.ceil(a/1e5)/10}[`:a<0x9184e729fff?`${Math.ceil(t/1e6)/1}[~${Math.ceil(a/1e6)/1}[`:a<0x38d7ea4c67fff?`${Math.ceil(t/1e9)/1e3}!~${Math.ceil(a/1e9)/1e3}!`:a<1e17?`${Math.ceil(t/1e11)/10}!~${Math.ceil(a/1e11)/10}!`:a<1e19?`${Math.ceil(t/1e12)/1}!~${Math.ceil(a/1e12)/1}!`:a<1e21?`|${Math.ceil(t/1e15)/1e3}~${Math.ceil(a/1e15)/1e3}`:a<1e23?`|${Math.ceil(t/1e17)/10}~${Math.ceil(a/1e17)/10}`:`|${Math.ceil(t/1e18)/1}~${Math.ceil(a/1e18)/1}`]}])},736094,e=>{"use strict";e.i(350461);var t=e.i(608580),a=e.i(931),s=e.i(478627),n=e.i(24174),o=e.i(21294),o=o;let r="https://profiles.idleontoolbox.workers.dev/api",i=async({profile:e,leaderboardConsent:t},a)=>{try{let s=g(e),n=await fetch(`${r}/profiles`,{method:"POST",body:JSON.stringify({profile:s,leaderboardConsent:t}),headers:{"Content-Type":"application/json",Authorization:a}});if(n?.status!==200)throw n;return n}catch(e){if(console.error("Error has occurred: ",e),e?.status===429)throw"You have uploaded your profile in the past 4 hours. Please wait until the cooldown is over.";throw e?.status===500||e?.status,"An error has occurred while uploading your profile. Please try again later."}},l=async({mainChar:e})=>{try{let t=await fetch(`${r}/profiles/?profile=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t)return null;return await t?.json()}catch(t){throw console.error(`/ROOT/services/profiles.js -> Error has occurred while getting profile for ${e}`),t}},u=async e=>{try{let t=await fetch(`${r}/leaderboards?leaderboard=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t)return null;return await t?.json()}catch(e){throw console.error("/ROOT/services/profiles.js -> Error has occurred while getting leaderboards"),e}},c=async(e,t)=>{try{let a=await fetch(`${r}/leaderboards?leaderboard=${e}&leaderboardUser=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!a)return null;return await a?.json()}catch(e){throw console.error("/ROOT/services/profiles.js -> Error has occurred while getting leaderboards"),e}},d=(e,t=0)=>isNaN(e)?t:e,g=e=>{let a=Object.entries(e.data).reduce((e,[a,s])=>(e[a]=(0,t.tryToParse)(s),e),{});return{...e,data:a}};e.s(["expandLeaderboardInfo",0,(e,t)=>{let r=Math.max(...t.map(s=>(0,a.getDropRate)(s,e,t)?.dropRate||0)),i=Math.max(...t.map(s=>(0,a.getCashMulti)(s,e,t)?.cashMulti||0)),l=t.map(a=>(0,s.getMaxDamage)(a,t,e)),u=Math.max(...l.map(({defence:e})=>e?.value)),c=Math.max(...l.map(({accuracy:e})=>e)),g=Math.max(...l.map(({maxHp:e})=>e)),p=Math.max(...l.map(({maxMp:e})=>e)),m=e?.deathNote?.[0]?.mobs?.[0]?.kills||0,f=(0,n.calcTotalBoatLevels)(e?.sailing?.boats),B=e?.tome?.totalPoints,h=e?.gaming?.logBook?.reduce((e,{unlocked:t})=>e+t,0),y=e?.hole?.villagers?.map(({expRate:e})=>e.value)?.filter(e=>e>0),v=y?.length>0?Math.max(...y):0;return{dropRate:Math.max(r,d(e.accountOptions?.[200])),defence:d(u),accuracy:d(c),hp:d(g),mp:d(p),logBook:h,totalShinyLevels:d(e?.breeding?.totalShinyLevels),totalBreedabilityLevels:d(e?.breeding?.totalBreedabilityLv),slab:d(e?.looty?.lootedItems,0),greenMushroomKills:m,totalBoats:f,totalTomePoints:d(B,0),highestVillagerExpPerHour:v,topKilledMonsters:e?.topKilledMonsters,accountAge:(0,o.default)(new Date,new Date(e?.accountCreateTime)),currentWorld:e?.currentWorld,cashMulti:d(i)}},"fetchLeaderboard",0,u,"fetchUserLeaderboards",0,c,"getProfile",0,l,"uploadProfile",0,i],736094)},985978,e=>{"use strict";e.s(["AppContext",()=>d,"default",()=>v]);var t=e.i(391398),a=e.i(191788),s=e.i(153712),n=e.i(94995),o=e.i(203828),r=e.i(46300),i=e.i(571853),l=e.i(575982),u=e.i(750935),c=e.i(736094);let d=(0,a.createContext)({}),g="data",p="logout",m="loginError",f="setLoading";function B(e,t){let a={login:()=>({...e,...t.data}),[g]:()=>({...e,...t.data}),[p]:()=>({characters:null,account:null,signedIn:!1,emailPassword:null,appleLogin:null}),displayedCharacters:()=>({...e,displayedCharacters:t.data}),filters:()=>({...e,filters:t.data}),pinnedPages:()=>({...e,pinnedPages:t.data}),planner:()=>({...e,planner:t.data}),trackers:()=>({...e,trackers:t.data}),godPlanner:()=>({...e,godPlanner:t.data}),[m]:()=>({...e,loginError:t.data}),showRankOneOnly:()=>({...e,showRankOneOnly:t.data}),showUnmaxedBoxesOnly:()=>({...e,showUnmaxedBoxesOnly:t.data}),[f]:()=>({...e,isLoading:t.data})}[t.type];if(!a)throw Error(`Unhandled action type: ${t.type}`);return a()}let h=["filters","pinnedPages","displayedCharacters","trackers","godPlanner","manualImport","lastUpdated","planner"];function y(){let e=h.reduce((e,t)=>{try{let a=localStorage.getItem(t);a&&(e[t]=JSON.parse(a))}catch(e){console.warn(`Failed to parse ${t} from localStorage:`,e)}return e},{});return e.pinnedPages||(e.pinnedPages=[]),{showRankOneOnly:!1,showUnmaxedBoxesOnly:!1,isLoading:!0,...e}}let v=({children:h})=>{let[v,S]=(0,a.useReducer)(B,{},y),T=(0,o.useRouter)(),[_,b]=(0,a.useState)(0),[M,A]=(0,a.useState)(!1),I=(0,a.useRef)(null),O=(0,a.useRef)(!1),C=async(t,a,s,n,o,r,i,l)=>{if(T?.query?.profile){let{profile:e,...t}=T.query;T.replace({query:t})}let u=r?.seconds,c=new Date().getTime();localStorage.setItem("rawJson",JSON.stringify({data:t,charNames:a,companion:s,guildData:n,serverVars:o,accountCreateTime:1e3*u,lastUpdated:c}));let{parseData:d}=await e.A(730819),p=d(t,a,s,n,o,1e3*u);localStorage.setItem("manualImport",JSON.stringify(!1)),S({type:g,data:{...p,signedIn:!0,manualImport:!1,profile:!1,lastUpdated:c,serverVars:o,uid:i,accessToken:l,accountCreateTime:1e3*u,isLoading:!1}}),void 0!==window?.gtag&&window.gtag("event","save_imported",{event_category:"engagement",event_label:"cloud",value:p?.characters?.length??0}),p=null},E=(e,t)=>{I.current&&I.current(),(0,s.userSignOut)(),void 0!==window?.gtag&&window.gtag("event","logout",{action:"logout",category:"engagement",value:1}),localStorage.removeItem("charactersData"),localStorage.removeItem("rawJson"),S({type:p}),A(!1),e?S({type:g,data:t}):T.push({pathname:"/",query:T.query})};return(0,a.useEffect)(()=>{if(!T.isReady)return;let t=async()=>{try{let t,a=await (0,c.getProfile)({mainChar:T?.query?.profile});if(!a)throw Error("Failed to load data from profile api");let{parseData:n}=await e.A(730819);if(Object.keys(a).includes("serverVars")){let{data:e,charNames:s,companion:o,guildData:r,serverVars:i,lastUpdated:l,accountCreateTime:u}=a;t=n(e,s,o,r,i,u);let c=l||new Date().getTime();t={...t,lastUpdated:c},localStorage.setItem("rawJson",JSON.stringify({data:e,charNames:s,guildData:r,serverVars:i,lastUpdated:c}))}else t=n(a);localStorage.setItem("manualImport","false");let o=t?.lastUpdated||new Date().getTime(),r=await (0,s.checkUserStatus)();S({type:g,data:{...t,profile:!0,manualImport:!1,signedIn:!!r,lastUpdated:o,isLoading:!1}}),void 0!==window?.gtag&&window.gtag("event","save_imported",{event_category:"engagement",event_label:"profile",value:t?.characters?.length??0})}catch(e){console.error("Failed to load data from profile api",e),T.push({pathname:"/",query:T.query}),S({type:g,data:{isLoading:!1}})}},a=async()=>{let{data:t,charNames:a,companion:s,guildData:o,serverVars:r,lastUpdated:i}=n.default,{parseData:l}=await e.A(730819),u=i||new Date().getTime(),c=l(t,a,s,o,r);S({type:g,data:{...c,lastUpdated:u,demo:!0,isLoading:!1}}),void 0!==window?.gtag&&window.gtag("event","save_imported",{event_category:"engagement",event_label:"demo",value:c?.characters?.length??0})},o=async()=>{try{let e=await (0,s.checkUserStatus)();!v?.account&&e?I.current=await (0,s.subscribe)(e?.uid,e?.accessToken,C):("/"===T.pathname||(()=>{if(!T.pathname.includes("tools"))return!1;let e=T.pathname.split("/")?.[2]||"",t=e?.replace("-"," ")?.toCamelCase();return!v?.signedIn&&T.pathname.includes("tools")&&l.offlineTools[t]})()||"/data"===T.pathname||"/statistics"===T.pathname||"/leaderboards"===T.pathname||T.push({pathname:"/",query:T?.query}),S({type:f,data:!1}))}catch(e){console.error(e),S({type:f,data:!1}),E()}};return(async()=>{T?.query?.profile?await t():T?.query?.demo?await a():v?.signedIn?S({type:f,data:!1}):await o()})(),()=>{I.current&&I.current()}},[T.isReady]),(0,a.useEffect)(()=>{if(!O.current){O.current=!0;return}if(v?.filters&&localStorage.setItem("filters",JSON.stringify(v.filters)),v?.pinnedPages&&localStorage.setItem("pinnedPages",JSON.stringify(v.pinnedPages)),v?.displayedCharacters&&localStorage.setItem("displayedCharacters",JSON.stringify(v.displayedCharacters)),v?.planner&&localStorage.setItem("planner",JSON.stringify(v.planner)),v?.trackers&&localStorage.setItem("trackers",JSON.stringify(v.trackers)),v?.godPlanner&&localStorage.setItem("godPlanner",JSON.stringify(v.godPlanner)),v?.manualImport){localStorage.setItem("manualImport",JSON.stringify(v.manualImport));let e=JSON.parse(localStorage.getItem("lastUpdated"));v?.signedIn&&E(!0,{...v,lastUpdated:e,signedIn:!1,manualImport:!0})}},[v?.trackers,v?.pinnedPages,v?.filters,v?.displayedCharacters,v?.planner,v?.manualImport,v?.godPlanner]),(0,a.useEffect)(()=>{M||0===_||b(0)},[M,_]),(0,r.default)(async()=>{try{let e,t,a;if(v?.signedIn)return;if(v?.loginType==="steam"){let n=await (0,s.signInWithCustom)(v?.loginData?.token,S);a=n?.accessToken,e=n?.accessToken,t=n?.uid}else if(v?.loginType==="email")e=v?.loginData?.accessToken,t=v?.loginData?.uid,a=e;else{if(v?.loginType==="apple"){let t=await (0,u.geAppleStatus)(v?.loginData);t?.id_token&&(e=t)}else{let t=await (0,i.getUserToken)(v?.loginData?.deviceCode)||{};e=t?.id_token}if(e){let a=await (0,s.signInWithToken)(e,v?.loginType);t=a?.uid}}e?(I.current=await (0,s.subscribe)(t,a||e?.id_token,C),void 0!==window?.gtag&&window.gtag("event","login",{action:"login",category:"engagement",value:v?.emailPasswordLogin?"email-password":v?.appleLogin?"apple":"google"}),A(!1),b(0)):_>12&&(A(!1),S({type:m,data:"Reached maximum retry limit, please re-open this dialog"})),b(e=>e+1)}catch(e){console.error("Error during authentication:",e),A(!1),b(0),S({type:m,data:e?.message})}},M?0===_?1e3:4e3:null),(0,t.jsx)(d.Provider,{value:{state:v,dispatch:S,logout:E,waitingForAuth:M,setWaitingForAuth:A},children:h})}}]);